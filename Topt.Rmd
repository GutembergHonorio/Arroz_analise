---
output: html_document
---
```{r , include=F}
knitr::opts_chunk$set(warning = F, message = F)
```

```{r Diretório, include=FALSE} 
# DIRETÓRIO DOS DADOS 


## Carregue estes dados antes de manipular os demais aquivos filhos:


Caminho_dos_dados <- file.path("C:","Users","Gutemberg","Desktop","Mestrado","Dados da Dicertação","Dados Brutos","Merge_1980_2018.csv")
Tabelabruta<- read.csv(Caminho_dos_dados, header = TRUE, sep = ";", stringsAsFactors = FALSE) # tabela com os dados originais

### Tabelas acessório
     
TabelabrutaIRR = subset(Tabelabruta, SIST_CULT == "IRRIGATED")
TabelabrutaTA = subset(Tabelabruta, SIST_CULT == "UPLAND")
```
## Terras altas

 
Relação da temperatura média, máxima e mínima com a data de florecimento 
  
```{r , include=F}

# Pacotes necessários para esta operação

if(!require(tidyverse))
  install.packages("tidyverse")
if(!require(gridExtra)) 
  install.packages("gridExtra")
```
  
```{r, include=FALSE }


Temporario<- TabelabrutaTA %>% mutate( TMedia = ((Tmax_Media+Tmin_Media)/2)) %>% group_by(FLO) %>% summarise(TMedia= mean(TMedia)) %>% na.omit(Temporario)

 t_me<-ggplot(Temporario)+
  geom_point(aes(x=TMedia,y=FLO),Temporario, color= "#EA6E16")+
  geom_smooth(aes(x=TMedia,y=FLO), se= T, method='lm', color = "black")+
  labs(x="Temperatura média (ºC)", y="Data de florecimento (DAE)")+
  theme(plot.title = element_text(hjust = 0.5))


a<-c(var(x=Temporario$TMedia,y=Temporario$FLO)) 
c<-c(cor(x=Temporario$TMedia,y=Temporario$FLO)^2)
d<-cor.test(y=Temporario$FLO, x=Temporario$TMedia, method="pearson") #pearson , spearman ou kendall
f<-data.frame("Estatística" =c("S²", "Cor", "r²","Valor_P"))
E<-data.frame("T. média" =c(a,d$estimate, c , d$p.value))
Corre_est<-tableGrob(f)
Corre_med<-tableGrob(E)

rm(Temporario)

```

```{r, include=FALSE}

Temporario<- TabelabrutaTA %>% group_by(FLO) %>% summarise(Tmax = mean(Tmax_Media)) %>% na.omit(Temporario)

t_ma<-ggplot(Temporario)+
  geom_point(aes(x=Tmax,y=FLO),Temporario, color= "#EA6E16")+
  geom_smooth(aes(x=Tmax,y=FLO), se= T, method='lm', color = "black")+
  labs(x="Temperatura máxima (ºC)", y="Data de florecimento (DAE)" )+
  theme(plot.title = element_text(hjust = 0.5))

a<-c(var(x=Temporario$Tmax,y=Temporario$FLO)) 
c<-c(cor(x=Temporario$Tmax,y=Temporario$FLO)^2)
d<-cor.test(y=Temporario$FLO, x=Temporario$Tmax, method="pearson") #pearson , spearman ou kendall
E<-data.frame("T. máxima" =c(a,d$estimate, c , d$p.value))

Corre_max<-tableGrob(E)
```
```{r, include=FALSE}
Temporario<- TabelabrutaTA %>% group_by(FLO) %>% summarise(Tmin = mean(Tmin_Media)) %>% na.omit(Temporario)

t_mi<-ggplot(Temporario)+
  geom_point(aes(x=Tmin,y=FLO),Temporario, color= "#EA6E16")+
  geom_smooth(aes(x=Tmin,y=FLO), se= T, method='lm', color = "black")+
  labs(x="Temperatura mínima (ºC)", y="Data de florecimento (DAE)")+
  theme(plot.title = element_text(hjust = 0.5))

a<-c(var(x=Temporario$Tmin,y=Temporario$FLO)) 
c<-c(cor(x=Temporario$Tmin,y=Temporario$FLO)^2)
d<-cor.test(y=Temporario$FLO, x=Temporario$Tmin, method="pearson") #pearson , spearman ou kendall
E<-data.frame("T. mínima" =c(a,d$estimate, c , d$p.value))

Corre_min<-tableGrob(E)

```


```{r, echo=FALSE, fig.align='center', out.width='100%', fig.asp=0.6, fig.width=9}

T_O_TA<-grid.arrange(t_me, t_ma, t_mi, ncol=3)
Corre_TA<-grid.arrange(Corre_est,Corre_med,Corre_max,Corre_min, ncol=4)
T_O_TA
Corre_TA
```


  A menor data de floração foi aos **46** dias após a emergência, onde a temperatura foi **26,81ºC**. 

## Irrigado
Relação da temperatura média, máxima e mínima com a data de florecimento 
```{r, include=FALSE }

Temporario<- TabelabrutaIRR %>% mutate( TMedia = ((Tmax_Media+Tmin_Media)/2)) %>% group_by(FLO) %>% summarise(TMedia= mean(TMedia)) %>% na.omit(Temporario)

 t_me<-ggplot(Temporario)+
  geom_point(aes(x=TMedia,y=FLO),Temporario, color= "blue")+
  geom_smooth(aes(x=TMedia,y=FLO), se= T, method='lm', color = "black")+
  labs(x="Temperatura média (ºC)", y="Data de florecimento (DAE)")+
  theme(plot.title = element_text(hjust = 0.5))


a<-c(var(x=Temporario$TMedia,y=Temporario$FLO)) 
c<-c(cor(x=Temporario$TMedia,y=Temporario$FLO)^2)
d<-cor.test(y=Temporario$FLO, x=Temporario$TMedia, method="pearson") #pearson , spearman ou kendall
f<-data.frame("Estatística" =c("S²", "Cor", "r²","Valor_P"))
E<-data.frame("T. média" =c(a,d$estimate, c , d$p.value))
Corre_est<-tableGrob(f)
Corre_med<-tableGrob(E)

rm(Temporario)

```

```{r, include=FALSE }

Temporario<- TabelabrutaIRR %>% group_by(FLO) %>% summarise(Tmax = mean(Tmax_Media)) %>% na.omit(Temporario)

t_ma<-ggplot(Temporario)+
  geom_point(aes(x=Tmax,y=FLO),Temporario, color= "blue")+
  geom_smooth(aes(x=Tmax,y=FLO), se= T, method='lm', color = "black")+
  labs(x="Temperatura máxima (ºC)", y="Data de florecimento (DAE)" )+
  theme(plot.title = element_text(hjust = 0.5))

a<-c(var(x=Temporario$Tmax,y=Temporario$FLO)) 
c<-c(cor(x=Temporario$Tmax,y=Temporario$FLO)^2)
d<-cor.test(y=Temporario$FLO, x=Temporario$Tmax, method="pearson") #pearson , spearman ou kendall
E<-data.frame("T. máxima" =c(a,d$estimate, c , d$p.value))

Corre_max<-tableGrob(E)
```
```{r, include=FALSE }
Temporario<- TabelabrutaIRR %>% group_by(FLO) %>% summarise(Tmin = mean(Tmin_Media)) %>% na.omit(Temporario)

t_mi<-ggplot(Temporario)+
  geom_point(aes(x=Tmin,y=FLO),Temporario, color= "blue")+
  geom_smooth(aes(x=Tmin,y=FLO), se= T, method='lm', color = "black")+
  labs(x="Temperatura mínima (ºC)", y="Data de florecimento (DAE)")+
  theme(plot.title = element_text(hjust = 0.5))

a<-c(var(x=Temporario$Tmin,y=Temporario$FLO)) 
c<-c(cor(x=Temporario$Tmin,y=Temporario$FLO)^2)
d<-cor.test(y=Temporario$FLO, x=Temporario$Tmin, method="pearson") #pearson , spearman ou kendall
E<-data.frame("T. mínima" =c(a,d$estimate, c , d$p.value))

Corre_min<-tableGrob(E)

```
```{r, echo=FALSE, message=FALSE,warning=FALSE, fig.align='center', out.width='100%', fig.asp=0.6, fig.width=9}
rm(Temporario)
T_O_IRR<-grid.arrange(t_me, t_ma, t_mi, ncol=3)
Corre_IRR<-grid.arrange(Corre_est,Corre_med,Corre_max,Corre_min, ncol=4)
T_O_IRR
Corre_IRR
```
  
  A menor data de floração foi aos **51** dias após a emergência onde a temperatura foi **27,36ºC**.
  
    
### Irrigado subtropical
  
Relação da temperatura média, máxima e mínima com a data de florecimento 
```{r, include=FALSE  , include=F}
Temporario2<- TabelabrutaIRR %>% mutate( Clima= case_when(latitude < -29 ~ "subtropical", latitude > -30 ~ "tropical"))

Temporario<- Temporario2 %>% filter(Clima=="subtropical") %>%  mutate( TMedia = ((Tmax_Media+Tmin_Media)/2)) %>% group_by(FLO) %>% summarise(TMedia = mean(TMedia)) %>% na.omit(Temporario)


 t_me<-ggplot(Temporario)+
  geom_point(aes(x=TMedia,y=FLO),Temporario, color= "blue")+
  geom_smooth(aes(x=TMedia,y=FLO), se= T, method='lm', color = "black")+
  labs(x="Temperatura média (ºC)", y="Data de florecimento (DAE)")+
  theme(plot.title = element_text(hjust = 0.5))


a<-c(var(x=Temporario$TMedia,y=Temporario$FLO)) 
c<-c(cor(x=Temporario$TMedia,y=Temporario$FLO)^2)
d<-cor.test(y=Temporario$FLO, x=Temporario$TMedia, method="pearson") #pearson , spearman ou kendall
f<-data.frame("Estatística" =c("S²", "Cor", "r²","Valor_P"))
E<-data.frame("T. média" =c(a,d$estimate, c , d$p.value))
Corre_est<-tableGrob(f)
Corre_med<-tableGrob(E)

rm(Temporario)

```

```{r, include=FALSE }
Temporario<- Temporario2 %>% filter(Clima=="subtropical") %>%  group_by(FLO) %>% summarise(Tmax = mean(Tmax_Media)) %>% na.omit(Temporario)


t_ma<-ggplot(Temporario)+
  geom_point(aes(x=Tmax,y=FLO),Temporario, color= "blue")+
  geom_smooth(aes(x=Tmax,y=FLO), se= T, method='lm', color = "black")+
  labs(x="Temperatura máxima (ºC)", y="Data de florecimento (DAE)" )+
  theme(plot.title = element_text(hjust = 0.5))

a<-c(var(x=Temporario$Tmax,y=Temporario$FLO)) 
c<-c(cor(x=Temporario$Tmax,y=Temporario$FLO)^2)
d<-cor.test(y=Temporario$FLO, x=Temporario$Tmax, method="pearson") #pearson , spearman ou kendall
E<-data.frame("T. máxima" =c(a,d$estimate, c , d$p.value))

Corre_max<-tableGrob(E)
```
```{r, include=FALSE }
Temporario<- Temporario2 %>% filter(Clima=="subtropical") %>%  group_by(FLO) %>% summarise(Tmin = mean(Tmin_Media)) %>% na.omit(Temporario)

t_mi<-ggplot(Temporario)+
  geom_point(aes(x=Tmin,y=FLO),Temporario, color= "blue")+
  geom_smooth(aes(x=Tmin,y=FLO), se= T, method='lm', color = "black")+
  labs(x="Temperatura mínima (ºC)", y="Data de florecimento (DAE)")+
  theme(plot.title = element_text(hjust = 0.5))

a<-c(var(x=Temporario$Tmin,y=Temporario$FLO)) 
c<-c(cor(x=Temporario$Tmin,y=Temporario$FLO)^2)
d<-cor.test(y=Temporario$FLO, x=Temporario$Tmin, method="pearson") #pearson , spearman ou kendall
E<-data.frame("T. mínima" =c(a,d$estimate, c , d$p.value))

Corre_min<-tableGrob(E)

```
```{r, echo=FALSE,  fig.align='center', out.width='100%', fig.asp=0.6, fig.width=9}
rm(Temporario)
T_O_IRR<-grid.arrange(t_me, t_ma, t_mi, ncol=3)
Corre_IRR<-grid.arrange(Corre_est,Corre_med,Corre_max,Corre_min, ncol=4)
T_O_IRR
Corre_IRR
```
  
  A menor data de floração foi aos **66** dias após a emergência onde a temperatura foi **22,36ºC**.
  

### Irrigado tropical

Relação da temperatura média, máxima e mínima com a data de florecimento 
```{r, include=FALSE}
Temporario2<- TabelabrutaIRR %>% mutate( Clima= case_when(latitude < -29 ~ "subtropical", latitude > -30 ~ "tropical"))

Temporario<- Temporario2 %>% filter(Clima=="tropical") %>%  mutate( TMedia = ((Tmax_Media+Tmin_Media)/2)) %>% group_by(FLO) %>% summarise(TMedia = mean(TMedia)) %>% na.omit(Temporario)


 t_me<-ggplot(Temporario)+
  geom_point(aes(x=TMedia,y=FLO),Temporario, color= "blue")+
  geom_smooth(aes(x=TMedia,y=FLO), se= T, method='lm', color = "black")+
  labs(x="Temperatura média (ºC)", y="Data de florecimento (DAE)")+
  theme(plot.title = element_text(hjust = 0.5))


a<-c(var(x=Temporario$TMedia,y=Temporario$FLO)) 
c<-c(cor(x=Temporario$TMedia,y=Temporario$FLO)^2)
d<-cor.test(y=Temporario$FLO, x=Temporario$TMedia, method="pearson") #pearson , spearman ou kendall
f<-data.frame("Estatística" =c("S²", "Cor", "r²","Valor_P"))
E<-data.frame("T. média" =c(a,d$estimate, c , d$p.value))
Corre_est<-tableGrob(f)
Corre_med<-tableGrob(E)

rm(Temporario)

```

```{r, include=FALSE }
Temporario<- Temporario2 %>% filter(Clima=="tropical") %>%  group_by(FLO) %>% summarise(Tmax = mean(Tmax_Media)) %>% na.omit(Temporario)


t_ma<-ggplot(Temporario)+
  geom_point(aes(x=Tmax,y=FLO),Temporario, color= "blue")+
  geom_smooth(aes(x=Tmax,y=FLO), se= T, method='lm', color = "black")+
  labs(x="Temperatura máxima (ºC)", y="Data de florecimento (DAE)" )+
  theme(plot.title = element_text(hjust = 0.5))

a<-c(var(x=Temporario$Tmax,y=Temporario$FLO)) 
c<-c(cor(x=Temporario$Tmax,y=Temporario$FLO)^2)
d<-cor.test(y=Temporario$FLO, x=Temporario$Tmax, method="pearson") #pearson , spearman ou kendall
E<-data.frame("T. máxima" =c(a,d$estimate, c , d$p.value))

Corre_max<-tableGrob(E)
```
```{r, include=FALSE }
Temporario<- Temporario2 %>% filter(Clima=="tropical") %>%  group_by(FLO) %>% summarise(Tmin = mean(Tmin_Media)) %>% na.omit(Temporario)

t_mi<-ggplot(Temporario)+
  geom_point(aes(x=Tmin,y=FLO),Temporario, color= "blue")+
  geom_smooth(aes(x=Tmin,y=FLO), se= T, method='lm', color = "black")+
  labs(x="Temperatura mínima (ºC)", y="Data de florecimento (DAE)")+
  theme(plot.title = element_text(hjust = 0.5))

a<-c(var(x=Temporario$Tmin,y=Temporario$FLO)) 
c<-c(cor(x=Temporario$Tmin,y=Temporario$FLO)^2)
d<-cor.test(y=Temporario$FLO, x=Temporario$Tmin, method="pearson") #pearson , spearman ou kendall
E<-data.frame("T. mínima" =c(a,d$estimate, c , d$p.value))

Corre_min<-tableGrob(E)

```
```{r, echo=FALSE, fig.align='center', out.width='100%', fig.asp=0.6, fig.width=9}
T_O_IRR<-grid.arrange(t_me, t_ma, t_mi, ncol=3)
Corre_IRR<-grid.arrange(Corre_est,Corre_med,Corre_max,Corre_min, ncol=4)
T_O_IRR
Corre_IRR
```
```{r , include=F}
rm(Temporario)
rm(a ,b,c,E)
rm(Corre_est,Corre_med,Corre_max,Corre_min, t_me, t_ma, t_mi)
```
  
  A menor data de floração foi aos **51** dias após a emergência onde a temperatura foi **27,36ºC**.
  