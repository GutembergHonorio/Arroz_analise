---
output: html_document
---
# Determinação da temperatura ótima
  
```{r , include=F}
knitr::opts_chunk$set(warning = F, message = F , echo = F)
```

```{r Diretório, include=FALSE} 
# DIRETÓRIO DOS DADOS 


## Carregue estes dados antes de manipular os demais aquivos filhos:


Caminho_dos_dados <- file.path("C:","Users","Gutemberg","Desktop","Mestrado","Dados da Dicertação","Dados Brutos","Merge_1980_2018.csv")
Tabelabruta<- read.csv(Caminho_dos_dados, header = TRUE, sep = ";", stringsAsFactors = FALSE) # tabela com os dados originais

### Tabelas acessório
     
TabelabrutaIRR = subset(Tabelabruta, SIST_CULT == "IRRIGATED")
TabelabrutaTA = subset(Tabelabruta, SIST_CULT == "UPLAND")

```
  
    
## Terras altas

 
Relação da temperatura média, máxima e mínima com a data de florecimento 
  
```{r , include=F}

# Pacotes necessários para esta operação

if(!require(tidyverse))
  install.packages("tidyverse")
if(!require(gridExtra)) 
  install.packages("gridExtra")
```
  
```{r, include=FALSE }


Temporario<- TabelabrutaTA %>% mutate( TMedia = ((Tmax_Media+Tmin_Media)/2)) %>% group_by(FLO) %>% summarise(TMedia= mean(TMedia)) %>% na.omit(Temporario)

 t_me<-ggplot(Temporario)+
  geom_point(aes(x=TMedia,y=FLO),Temporario, color= "#EA6E16")+
  geom_smooth(aes(x=TMedia,y=FLO), se= T, method='lm', color = "black")+
  labs(x="Temperatura média (ºC)", y="Data de florecimento (DAE)")+
  theme(plot.title = element_text(hjust = 0.5))
```
```{r , echo=FALSE}


    # teste de normalidade dos dados

b<-shapiro.test(Temporario$TMedia)
alfa<-0.05
c<- data.frame(c(b$p.value)) ; c<- c %>% mutate( resultado = case_when(c$c.b.p.value. <  alfa ~ "rejeita-se H0", c$c.b.p.value. > alfa ~ " não rejeita-se H0" , c$c.b.p.value. == alfa ~ " não rejeita-se H0" )) ; c<- c %>%  mutate( teste = case_when(resultado == "rejeita-se H0"  ~ "não paramétricos", resultado != "rejeita-se H0"  ~ "paramétricos" ))

m<- c %>% mutate( metodo = case_when(resultado == "rejeita-se H0" ~  "spearman", resultado != "rejeita-se H0"  ~ "pearson" ))
metodo<-m$metodo 

normalidade<-c$resultado 

```

```{r}
# Estatistica
 
a<-c(var(x=Temporario$TMedia,y=Temporario$FLO)) 
c<-c(cor(x=Temporario$TMedia,y=Temporario$FLO)^2)
d<-cor.test(y=Temporario$FLO, x=Temporario$TMedia, method= metodo) 
f<-data.frame("Estatística" =c("S²", "Cor", "r²","Teste Shapiro-Wilk", "Metodo", "Valor_P"))
E<-data.frame("T. média" =c(a,d$estimate, c ,normalidade, metodo, d$p.value ))
Corre_est<-tableGrob(f)
Corre_med<-tableGrob(E)


```
```{r}
tem<-sort(Temporario$FLO)
n<-tem[1]
Te<-subset(Temporario, FLO == n)
rm(tem,n)
```

```{r, include=FALSE}

Temporario<- TabelabrutaTA %>% group_by(FLO) %>% summarise(Tmax = mean(Tmax_Media)) %>% na.omit(Temporario)

t_ma<-ggplot(Temporario)+
  geom_point(aes(x=Tmax,y=FLO),Temporario, color= "#EA6E16")+
  geom_smooth(aes(x=Tmax,y=FLO), se= T, method='lm', color = "black")+
  labs(x="Temperatura máxima (ºC)", y="Data de florecimento (DAE)" )+
  theme(plot.title = element_text(hjust = 0.5))
```
```{r , echo=FALSE}


    # teste de normalidade dos dados

b<-shapiro.test(Temporario$Tmax)
alfa<-0.05
c<- data.frame(c(b$p.value)) ; c<- c %>% mutate( resultado = case_when(c$c.b.p.value. <  alfa ~ "rejeita-se H0", c$c.b.p.value. > alfa ~ " não rejeita-se H0" , c$c.b.p.value. == alfa ~ " não rejeita-se H0" )) ; c<- c %>%  mutate( teste = case_when(resultado == "rejeita-se H0"  ~ "não paramétricos", resultado != "rejeita-se H0"  ~ "paramétricos" ))

m<- c %>% mutate( metodo = case_when(resultado == "rejeita-se H0" ~  "spearman", resultado != "rejeita-se H0"  ~ "pearson" ))
metodo<-m$metodo 

normalidade<-c$resultado 

```
```{r}

a<-c(var(x=Temporario$Tmax,y=Temporario$FLO)) 
c<-c(cor(x=Temporario$Tmax,y=Temporario$FLO)^2)
d<-cor.test(y=Temporario$FLO, x=Temporario$Tmax, method= metodo) 
E<-data.frame("T. máxima" =c(a,d$estimate, c , normalidade, metodo, d$p.value))

Corre_max<-tableGrob(E)
```
```{r, include=FALSE}
Temporario<- TabelabrutaTA %>% group_by(FLO) %>% summarise(Tmin = mean(Tmin_Media)) %>% na.omit(Temporario)

t_mi<-ggplot(Temporario)+
  geom_point(aes(x=Tmin,y=FLO),Temporario, color= "#EA6E16")+
  geom_smooth(aes(x=Tmin,y=FLO), se= T, method='lm', color = "black")+
  labs(x="Temperatura mínima (ºC)", y="Data de florecimento (DAE)")+
  theme(plot.title = element_text(hjust = 0.5))
```
```{r , echo=FALSE}


    # teste de normalidade dos dados

b<-shapiro.test(Temporario$Tmin)
alfa<-0.05
c<- data.frame(c(b$p.value)) ; c<- c %>% mutate( resultado = case_when(c$c.b.p.value. <  alfa ~ "rejeita-se H0", c$c.b.p.value. > alfa ~ " não rejeita-se H0" , c$c.b.p.value. == alfa ~ " não rejeita-se H0" )) ; c<- c %>%  mutate( teste = case_when(resultado == "rejeita-se H0"  ~ "não paramétricos", resultado != "rejeita-se H0"  ~ "paramétricos" ))

m<- c %>% mutate( metodo = case_when(resultado == "rejeita-se H0" ~  "spearman", resultado != "rejeita-se H0"  ~ "pearson" ))
metodo<-m$metodo 

normalidade<-c$resultado

```
```{r}
a<-c(var(x=Temporario$Tmin,y=Temporario$FLO)) 
c<-c(cor(x=Temporario$Tmin,y=Temporario$FLO)^2)
d<-cor.test(y=Temporario$FLO, x=Temporario$Tmin, method=metodo) #pearson , spearman ou kendall
E<-data.frame("T. mínima" =c(a,d$estimate, c , normalidade , metodo , d$p.value))

Corre_min<-tableGrob(E)

```


```{r, fig.align='center', out.width='100%', fig.asp=0.6, fig.width=9}

T_O_TA<-grid.arrange(t_me, t_ma, t_mi, ncol=3)
Corre_TA<-grid.arrange(Corre_est,Corre_med,Corre_max,Corre_min, ncol=4)
T_O_TA
Corre_TA
```


  A menor data de floração foi aos **`r Te[1,1]`** dias após a emergência, onde a temperatura média foi **`r Te[1,2]`****ºC**. 

  
### Terras altas subtropical
  
Relação da temperatura média, máxima e mínima com a data de florecimento 
```{r, include=FALSE  }
Temporario2<- TabelabrutaTA %>% mutate( Clima= case_when(latitude < -29 ~ "subtropical", latitude > -30 ~ "tropical"))

Temporario<- Temporario2 %>% filter(Clima=="subtropical") %>%  mutate( TMedia = ((Tmax_Media+Tmin_Media)/2)) %>% group_by(FLO) %>% summarise(TMedia = mean(TMedia)) %>% na.omit(Temporario)


 t_me<-ggplot(Temporario)+
  geom_point(aes(x=TMedia,y=FLO),Temporario, color= "#EA6E16")+
  geom_smooth(aes(x=TMedia,y=FLO), se= T, method='lm', color = "black")+
  labs(x="Temperatura média (ºC)", y="Data de florecimento (DAE)")+
  theme(plot.title = element_text(hjust = 0.5))
```

```{r , echo=FALSE}


    # teste de normalidade dos dados

b<-shapiro.test(Temporario$TMedia)
alfa<-0.05
c<- data.frame(c(b$p.value)) ; c<- c %>% mutate( resultado = case_when(c$c.b.p.value. <  alfa ~ "rejeita-se H0", c$c.b.p.value. > alfa ~ " não rejeita-se H0" , c$c.b.p.value. == alfa ~ " não rejeita-se H0" )) ; c<- c %>%  mutate( teste = case_when(resultado == "rejeita-se H0"  ~ "não paramétricos", resultado != "rejeita-se H0"  ~ "paramétricos" ))

m<- c %>% mutate( metodo = case_when(resultado == "rejeita-se H0" ~  "spearman", resultado != "rejeita-se H0"  ~ "pearson" ))
metodo<-m$metodo 

normalidade<-c$resultado 

```

```{r}
# Estatistica
 
a<-c(var(x=Temporario$TMedia,y=Temporario$FLO)) 
c<-c(cor(x=Temporario$TMedia,y=Temporario$FLO)^2)
d<-cor.test(y=Temporario$FLO, x=Temporario$TMedia, method= metodo) 
f<-data.frame("Estatística" =c("S²", "Cor", "r²","Teste Shapiro-Wilk", "Metodo", "Valor_P"))
E<-data.frame("T. média" =c(a,d$estimate, c ,normalidade, metodo, d$p.value ))
Corre_est<-tableGrob(f)
Corre_med<-tableGrob(E)


```

```{r}
tem<-sort(Temporario$FLO)
n<-tem[1]
Te<-subset(Temporario, FLO == n)
rm(tem,n)
```

```{r, include=FALSE }
Temporario<- Temporario2 %>% filter(Clima=="subtropical") %>%  group_by(FLO) %>% summarise(Tmax = mean(Tmax_Media)) %>% na.omit(Temporario)


t_ma<-ggplot(Temporario)+
  geom_point(aes(x=Tmax,y=FLO),Temporario, color= "#EA6E16")+
  geom_smooth(aes(x=Tmax,y=FLO), se= T, method='lm', color = "black")+
  labs(x="Temperatura máxima (ºC)", y="Data de florecimento (DAE)" )+
  theme(plot.title = element_text(hjust = 0.5))
```

```{r , echo=FALSE}


    # teste de normalidade dos dados

b<-shapiro.test(Temporario$Tmax)
alfa<-0.05
c<- data.frame(c(b$p.value)) ; c<- c %>% mutate( resultado = case_when(c$c.b.p.value. <  alfa ~ "rejeita-se H0", c$c.b.p.value. > alfa ~ " não rejeita-se H0" , c$c.b.p.value. == alfa ~ " não rejeita-se H0" )) ; c<- c %>%  mutate( teste = case_when(resultado == "rejeita-se H0"  ~ "não paramétricos", resultado != "rejeita-se H0"  ~ "paramétricos" ))

m<- c %>% mutate( metodo = case_when(resultado == "rejeita-se H0" ~  "spearman", resultado != "rejeita-se H0"  ~ "pearson" ))
metodo<-m$metodo 

normalidade<-c$resultado 

```

```{r}

a<-c(var(x=Temporario$Tmax,y=Temporario$FLO)) 
c<-c(cor(x=Temporario$Tmax,y=Temporario$FLO)^2)
d<-cor.test(y=Temporario$FLO, x=Temporario$Tmax, method= metodo) 
E<-data.frame("T. máxima" =c(a,d$estimate, c , normalidade, metodo, d$p.value))

Corre_max<-tableGrob(E)
```

```{r, include=FALSE }
Temporario<- Temporario2 %>% filter(Clima=="subtropical") %>%  group_by(FLO) %>% summarise(Tmin = mean(Tmin_Media)) %>% na.omit(Temporario)

t_mi<-ggplot(Temporario)+
  geom_point(aes(x=Tmin,y=FLO),Temporario, color= "#EA6E16")+
  geom_smooth(aes(x=Tmin,y=FLO), se= T, method='lm', color = "black")+
  labs(x="Temperatura mínima (ºC)", y="Data de florecimento (DAE)")+
  theme(plot.title = element_text(hjust = 0.5))
```
```{r , echo=FALSE}


    # teste de normalidade dos dados

b<-shapiro.test(Temporario$Tmin)
alfa<-0.05
c<- data.frame(c(b$p.value)) ; c<- c %>% mutate( resultado = case_when(c$c.b.p.value. <  alfa ~ "rejeita-se H0", c$c.b.p.value. > alfa ~ " não rejeita-se H0" , c$c.b.p.value. == alfa ~ " não rejeita-se H0" )) ; c<- c %>%  mutate( teste = case_when(resultado == "rejeita-se H0"  ~ "não paramétricos", resultado != "rejeita-se H0"  ~ "paramétricos" ))

m<- c %>% mutate( metodo = case_when(resultado == "rejeita-se H0" ~  "spearman", resultado != "rejeita-se H0"  ~ "pearson" ))
metodo<-m$metodo 

normalidade<-c$resultado

```
```{r}
a<-c(var(x=Temporario$Tmin,y=Temporario$FLO)) 
c<-c(cor(x=Temporario$Tmin,y=Temporario$FLO)^2)
d<-cor.test(y=Temporario$FLO, x=Temporario$Tmin, method=metodo) #pearson , spearman ou kendall
E<-data.frame("T. mínima" =c(a,d$estimate, c , normalidade , metodo , d$p.value))

Corre_min<-tableGrob(E)

```
```{r,  fig.align='center', out.width='100%', fig.asp=0.6, fig.width=9}

T_O_IRR<-grid.arrange(t_me, t_ma, t_mi, ncol=3)
Corre_IRR<-grid.arrange(Corre_est,Corre_med,Corre_max,Corre_min, ncol=4)
T_O_IRR
Corre_IRR
```
  
 A menor data de floração foi aos **`r Te[1,1]`** dias após a emergência, onde a temperatura média foi **`r Te[1,2]`****ºC**.   

### Terras altas tropical

Relação da temperatura média, máxima e mínima com a data de florecimento 
```{r, include=FALSE}
Temporario2<- TabelabrutaTA %>% mutate( Clima= case_when(latitude < -29 ~ "subtropical", latitude > -30 ~ "tropical"))

Temporario<- Temporario2 %>% filter(Clima=="tropical") %>%  mutate( TMedia = ((Tmax_Media+Tmin_Media)/2)) %>% group_by(FLO) %>% summarise(TMedia = mean(TMedia)) %>% na.omit(Temporario)


 t_me<-ggplot(Temporario)+
  geom_point(aes(x=TMedia,y=FLO),Temporario, color= "#EA6E16")+
  geom_smooth(aes(x=TMedia,y=FLO), se= T, method='lm', color = "black")+
  labs(x="Temperatura média (ºC)", y="Data de florecimento (DAE)")+
  theme(plot.title = element_text(hjust = 0.5))
```

```{r , echo=FALSE}


    # teste de normalidade dos dados

b<-shapiro.test(Temporario$TMedia)
alfa<-0.05
c<- data.frame(c(b$p.value)) ; c<- c %>% mutate( resultado = case_when(c$c.b.p.value. <  alfa ~ "rejeita-se H0", c$c.b.p.value. > alfa ~ " não rejeita-se H0" , c$c.b.p.value. == alfa ~ " não rejeita-se H0" )) ; c<- c %>%  mutate( teste = case_when(resultado == "rejeita-se H0"  ~ "não paramétricos", resultado != "rejeita-se H0"  ~ "paramétricos" ))

m<- c %>% mutate( metodo = case_when(resultado == "rejeita-se H0" ~  "spearman", resultado != "rejeita-se H0"  ~ "pearson" ))
metodo<-m$metodo 

normalidade<-c$resultado 

```

```{r}
# Estatistica
 
a<-c(var(x=Temporario$TMedia,y=Temporario$FLO)) 
c<-c(cor(x=Temporario$TMedia,y=Temporario$FLO)^2)
d<-cor.test(y=Temporario$FLO, x=Temporario$TMedia, method= metodo) 
f<-data.frame("Estatística" =c("S²", "Cor", "r²","Teste Shapiro-Wilk", "Metodo", "Valor_P"))
E<-data.frame("T. média" =c(a,d$estimate, c ,normalidade, metodo, d$p.value ))
Corre_est<-tableGrob(f)
Corre_med<-tableGrob(E)


```

```{r}
tem<-sort(Temporario$FLO)
n<-tem[1]
Te<-subset(Temporario, FLO == n)
rm(tem,n)
```
 
```{r, include=FALSE }
Temporario<- Temporario2 %>% filter(Clima=="tropical") %>%  group_by(FLO) %>% summarise(Tmax = mean(Tmax_Media)) %>% na.omit(Temporario)


t_ma<-ggplot(Temporario)+
  geom_point(aes(x=Tmax,y=FLO),Temporario, color= "#EA6E16")+
  geom_smooth(aes(x=Tmax,y=FLO), se= T, method='lm', color = "black")+
  labs(x="Temperatura máxima (ºC)", y="Data de florecimento (DAE)" )+
  theme(plot.title = element_text(hjust = 0.5))

```

```{r , echo=FALSE}


    # teste de normalidade dos dados

b<-shapiro.test(Temporario$Tmax)
alfa<-0.05
c<- data.frame(c(b$p.value)) ; c<- c %>% mutate( resultado = case_when(c$c.b.p.value. <  alfa ~ "rejeita-se H0", c$c.b.p.value. > alfa ~ " não rejeita-se H0" , c$c.b.p.value. == alfa ~ " não rejeita-se H0" )) ; c<- c %>%  mutate( teste = case_when(resultado == "rejeita-se H0"  ~ "não paramétricos", resultado != "rejeita-se H0"  ~ "paramétricos" ))

m<- c %>% mutate( metodo = case_when(resultado == "rejeita-se H0" ~  "spearman", resultado != "rejeita-se H0"  ~ "pearson" ))
metodo<-m$metodo 

normalidade<-c$resultado 

```

```{r}

a<-c(var(x=Temporario$Tmax,y=Temporario$FLO)) 
c<-c(cor(x=Temporario$Tmax,y=Temporario$FLO)^2)
d<-cor.test(y=Temporario$FLO, x=Temporario$Tmax, method= metodo) 
E<-data.frame("T. máxima" =c(a,d$estimate, c , normalidade, metodo, d$p.value))

Corre_max<-tableGrob(E)
```

```{r, include=FALSE }
Temporario<- Temporario2 %>% filter(Clima=="tropical") %>%  group_by(FLO) %>% summarise(Tmin = mean(Tmin_Media)) %>% na.omit(Temporario)

t_mi<-ggplot(Temporario)+
  geom_point(aes(x=Tmin,y=FLO),Temporario, color= "#EA6E16")+
  geom_smooth(aes(x=Tmin,y=FLO), se= T, method='lm', color = "black")+
  labs(x="Temperatura mínima (ºC)", y="Data de florecimento (DAE)")+
  theme(plot.title = element_text(hjust = 0.5))
```
```{r , echo=FALSE}


    # teste de normalidade dos dados

b<-shapiro.test(Temporario$Tmin)
alfa<-0.05
c<- data.frame(c(b$p.value)) ; c<- c %>% mutate( resultado = case_when(c$c.b.p.value. <  alfa ~ "rejeita-se H0", c$c.b.p.value. > alfa ~ " não rejeita-se H0" , c$c.b.p.value. == alfa ~ " não rejeita-se H0" )) ; c<- c %>%  mutate( teste = case_when(resultado == "rejeita-se H0"  ~ "não paramétricos", resultado != "rejeita-se H0"  ~ "paramétricos" ))

m<- c %>% mutate( metodo = case_when(resultado == "rejeita-se H0" ~  "spearman", resultado != "rejeita-se H0"  ~ "pearson" ))
metodo<-m$metodo 

normalidade<-c$resultado

```
```{r}
a<-c(var(x=Temporario$Tmin,y=Temporario$FLO)) 
c<-c(cor(x=Temporario$Tmin,y=Temporario$FLO)^2)
d<-cor.test(y=Temporario$FLO, x=Temporario$Tmin, method=metodo) #pearson , spearman ou kendall
E<-data.frame("T. mínima" =c(a,d$estimate, c , normalidade , metodo , d$p.value))

Corre_min<-tableGrob(E)

```
```{r,  fig.align='center', out.width='100%', fig.asp=0.6, fig.width=9}
T_O_IRR<-grid.arrange(t_me, t_ma, t_mi, ncol=3)
Corre_IRR<-grid.arrange(Corre_est,Corre_med,Corre_max,Corre_min, ncol=4)
T_O_IRR
Corre_IRR
```
```{r , include=F}
rm(Temporario)
rm(a ,b,c,E)
rm(Corre_est,Corre_med,Corre_max,Corre_min, t_me, t_ma, t_mi)
```
  
 A menor data de floração foi aos **`r Te[1,1]`** dias após a emergência, onde a temperatura média foi **`r Te[1,2]`****ºC**.
   
## Irrigado
  
Relação da temperatura média, máxima e mínima com a data de florecimento 
```{r, include=FALSE }

Temporario<- TabelabrutaIRR %>% mutate( TMedia = ((Tmax_Media+Tmin_Media)/2)) %>% group_by(FLO) %>% summarise(TMedia= mean(TMedia)) %>% na.omit(Temporario)

 t_me<-ggplot(Temporario)+
  geom_point(aes(x=TMedia,y=FLO),Temporario, color= "blue")+
  geom_smooth(aes(x=TMedia,y=FLO), se= T, method='lm', color = "black")+
  labs(x="Temperatura média (ºC)", y="Data de florecimento (DAE)")+
  theme(plot.title = element_text(hjust = 0.5))
```
```{r , echo=FALSE}


    # teste de normalidade dos dados

b<-shapiro.test(Temporario$TMedia)
alfa<-0.05
c<- data.frame(c(b$p.value)) ; c<- c %>% mutate( resultado = case_when(c$c.b.p.value. <  alfa ~ "rejeita-se H0", c$c.b.p.value. > alfa ~ " não rejeita-se H0" , c$c.b.p.value. == alfa ~ " não rejeita-se H0" )) ; c<- c %>%  mutate( teste = case_when(resultado == "rejeita-se H0"  ~ "não paramétricos", resultado != "rejeita-se H0"  ~ "paramétricos" ))

m<- c %>% mutate( metodo = case_when(resultado == "rejeita-se H0" ~  "spearman", resultado != "rejeita-se H0"  ~ "pearson" ))
metodo<-m$metodo 

normalidade<-c$resultado 

```

```{r}
# Estatistica
 
a<-c(var(x=Temporario$TMedia,y=Temporario$FLO)) 
c<-c(cor(x=Temporario$TMedia,y=Temporario$FLO)^2)
d<-cor.test(y=Temporario$FLO, x=Temporario$TMedia, method= metodo) 
f<-data.frame("Estatística" =c("S²", "Cor", "r²","Teste Shapiro-Wilk", "Metodo", "Valor_P"))
E<-data.frame("T. média" =c(a,d$estimate, c ,normalidade, metodo, d$p.value ))
Corre_est<-tableGrob(f)
Corre_med<-tableGrob(E)


```

```{r}
tem<-sort(Temporario$FLO)
n<-tem[1]
Te<-subset(Temporario, FLO == n)
rm(tem,n)
```

```{r, include=FALSE }

Temporario<- TabelabrutaIRR %>% group_by(FLO) %>% summarise(Tmax = mean(Tmax_Media)) %>% na.omit(Temporario)

t_ma<-ggplot(Temporario)+
  geom_point(aes(x=Tmax,y=FLO),Temporario, color= "blue")+
  geom_smooth(aes(x=Tmax,y=FLO), se= T, method='lm', color = "black")+
  labs(x="Temperatura máxima (ºC)", y="Data de florecimento (DAE)" )+
  theme(plot.title = element_text(hjust = 0.5))
```

```{r , echo=FALSE}


    # teste de normalidade dos dados

b<-shapiro.test(Temporario$Tmax)
alfa<-0.05
c<- data.frame(c(b$p.value)) ; c<- c %>% mutate( resultado = case_when(c$c.b.p.value. <  alfa ~ "rejeita-se H0", c$c.b.p.value. > alfa ~ " não rejeita-se H0" , c$c.b.p.value. == alfa ~ " não rejeita-se H0" )) ; c<- c %>%  mutate( teste = case_when(resultado == "rejeita-se H0"  ~ "não paramétricos", resultado != "rejeita-se H0"  ~ "paramétricos" ))

m<- c %>% mutate( metodo = case_when(resultado == "rejeita-se H0" ~  "spearman", resultado != "rejeita-se H0"  ~ "pearson" ))
metodo<-m$metodo 

normalidade<-c$resultado 

```

```{r}

a<-c(var(x=Temporario$Tmax,y=Temporario$FLO)) 
c<-c(cor(x=Temporario$Tmax,y=Temporario$FLO)^2)
d<-cor.test(y=Temporario$FLO, x=Temporario$Tmax, method= metodo) 
E<-data.frame("T. máxima" =c(a,d$estimate, c , normalidade, metodo, d$p.value))

Corre_max<-tableGrob(E)
```

```{r, include=FALSE }
Temporario<- TabelabrutaIRR %>% group_by(FLO) %>% summarise(Tmin = mean(Tmin_Media)) %>% na.omit(Temporario)

t_mi<-ggplot(Temporario)+
  geom_point(aes(x=Tmin,y=FLO),Temporario, color= "blue")+
  geom_smooth(aes(x=Tmin,y=FLO), se= T, method='lm', color = "black")+
  labs(x="Temperatura mínima (ºC)", y="Data de florecimento (DAE)")+
  theme(plot.title = element_text(hjust = 0.5))

```
```{r , echo=FALSE}


    # teste de normalidade dos dados

b<-shapiro.test(Temporario$Tmin)
alfa<-0.05
c<- data.frame(c(b$p.value)) ; c<- c %>% mutate( resultado = case_when(c$c.b.p.value. <  alfa ~ "rejeita-se H0", c$c.b.p.value. > alfa ~ " não rejeita-se H0" , c$c.b.p.value. == alfa ~ " não rejeita-se H0" )) ; c<- c %>%  mutate( teste = case_when(resultado == "rejeita-se H0"  ~ "não paramétricos", resultado != "rejeita-se H0"  ~ "paramétricos" ))

m<- c %>% mutate( metodo = case_when(resultado == "rejeita-se H0" ~  "spearman", resultado != "rejeita-se H0"  ~ "pearson" ))
metodo<-m$metodo 

normalidade<-c$resultado

```
```{r}
a<-c(var(x=Temporario$Tmin,y=Temporario$FLO)) 
c<-c(cor(x=Temporario$Tmin,y=Temporario$FLO)^2)
d<-cor.test(y=Temporario$FLO, x=Temporario$Tmin, method=metodo) #pearson , spearman ou kendall
E<-data.frame("T. mínima" =c(a,d$estimate, c , normalidade , metodo , d$p.value))

Corre_min<-tableGrob(E)

```
```{r,  message=FALSE,warning=FALSE, fig.align='center', out.width='100%', fig.asp=0.6, fig.width=9}
rm(Temporario)
T_O_IRR<-grid.arrange(t_me, t_ma, t_mi, ncol=3)
Corre_IRR<-grid.arrange(Corre_est,Corre_med,Corre_max,Corre_min, ncol=4)
T_O_IRR
Corre_IRR
```
  
   A menor data de floração foi aos **`r Te[1,1]`** dias após a emergência, onde a temperatura média foi **`r Te[1,2]`****ºC**. 
  
    
### Irrigado subtropical
  
Relação da temperatura média, máxima e mínima com a data de florecimento 
```{r, include=FALSE  }
Temporario2<- TabelabrutaIRR %>% mutate( Clima= case_when(latitude < -29 ~ "subtropical", latitude > -30 ~ "tropical"))

Temporario<- Temporario2 %>% filter(Clima=="subtropical") %>%  mutate( TMedia = ((Tmax_Media+Tmin_Media)/2)) %>% group_by(FLO) %>% summarise(TMedia = mean(TMedia)) %>% na.omit(Temporario)


 t_me<-ggplot(Temporario)+
  geom_point(aes(x=TMedia,y=FLO),Temporario, color= "blue")+
  geom_smooth(aes(x=TMedia,y=FLO), se= T, method='lm', color = "black")+
  labs(x="Temperatura média (ºC)", y="Data de florecimento (DAE)")+
  theme(plot.title = element_text(hjust = 0.5))
```

```{r , echo=FALSE}


    # teste de normalidade dos dados

b<-shapiro.test(Temporario$TMedia)
alfa<-0.05
c<- data.frame(c(b$p.value)) ; c<- c %>% mutate( resultado = case_when(c$c.b.p.value. <  alfa ~ "rejeita-se H0", c$c.b.p.value. > alfa ~ " não rejeita-se H0" , c$c.b.p.value. == alfa ~ " não rejeita-se H0" )) ; c<- c %>%  mutate( teste = case_when(resultado == "rejeita-se H0"  ~ "não paramétricos", resultado != "rejeita-se H0"  ~ "paramétricos" ))

m<- c %>% mutate( metodo = case_when(resultado == "rejeita-se H0" ~  "spearman", resultado != "rejeita-se H0"  ~ "pearson" ))
metodo<-m$metodo 

normalidade<-c$resultado 

```

```{r}
# Estatistica
 
a<-c(var(x=Temporario$TMedia,y=Temporario$FLO)) 
c<-c(cor(x=Temporario$TMedia,y=Temporario$FLO)^2)
d<-cor.test(y=Temporario$FLO, x=Temporario$TMedia, method= metodo) 
f<-data.frame("Estatística" =c("S²", "Cor", "r²","Teste Shapiro-Wilk", "Metodo", "Valor_P"))
E<-data.frame("T. média" =c(a,d$estimate, c ,normalidade, metodo, d$p.value ))
Corre_est<-tableGrob(f)
Corre_med<-tableGrob(E)


```

```{r}
tem<-sort(Temporario$FLO)
n<-tem[1]
Te<-subset(Temporario, FLO == n)
rm(tem,n)
```

```{r, include=FALSE }
Temporario<- Temporario2 %>% filter(Clima=="subtropical") %>%  group_by(FLO) %>% summarise(Tmax = mean(Tmax_Media)) %>% na.omit(Temporario)


t_ma<-ggplot(Temporario)+
  geom_point(aes(x=Tmax,y=FLO),Temporario, color= "blue")+
  geom_smooth(aes(x=Tmax,y=FLO), se= T, method='lm', color = "black")+
  labs(x="Temperatura máxima (ºC)", y="Data de florecimento (DAE)" )+
  theme(plot.title = element_text(hjust = 0.5))
```

```{r , echo=FALSE}


    # teste de normalidade dos dados

b<-shapiro.test(Temporario$Tmax)
alfa<-0.05
c<- data.frame(c(b$p.value)) ; c<- c %>% mutate( resultado = case_when(c$c.b.p.value. <  alfa ~ "rejeita-se H0", c$c.b.p.value. > alfa ~ " não rejeita-se H0" , c$c.b.p.value. == alfa ~ " não rejeita-se H0" )) ; c<- c %>%  mutate( teste = case_when(resultado == "rejeita-se H0"  ~ "não paramétricos", resultado != "rejeita-se H0"  ~ "paramétricos" ))

m<- c %>% mutate( metodo = case_when(resultado == "rejeita-se H0" ~  "spearman", resultado != "rejeita-se H0"  ~ "pearson" ))
metodo<-m$metodo 

normalidade<-c$resultado 

```

```{r}

a<-c(var(x=Temporario$Tmax,y=Temporario$FLO)) 
c<-c(cor(x=Temporario$Tmax,y=Temporario$FLO)^2)
d<-cor.test(y=Temporario$FLO, x=Temporario$Tmax, method= metodo) 
E<-data.frame("T. máxima" =c(a,d$estimate, c , normalidade, metodo, d$p.value))

Corre_max<-tableGrob(E)
```

```{r, include=FALSE }
Temporario<- Temporario2 %>% filter(Clima=="subtropical") %>%  group_by(FLO) %>% summarise(Tmin = mean(Tmin_Media)) %>% na.omit(Temporario)

t_mi<-ggplot(Temporario)+
  geom_point(aes(x=Tmin,y=FLO),Temporario, color= "blue")+
  geom_smooth(aes(x=Tmin,y=FLO), se= T, method='lm', color = "black")+
  labs(x="Temperatura mínima (ºC)", y="Data de florecimento (DAE)")+
  theme(plot.title = element_text(hjust = 0.5))
```
```{r , echo=FALSE}


    # teste de normalidade dos dados

b<-shapiro.test(Temporario$Tmin)
alfa<-0.05
c<- data.frame(c(b$p.value)) ; c<- c %>% mutate( resultado = case_when(c$c.b.p.value. <  alfa ~ "rejeita-se H0", c$c.b.p.value. > alfa ~ " não rejeita-se H0" , c$c.b.p.value. == alfa ~ " não rejeita-se H0" )) ; c<- c %>%  mutate( teste = case_when(resultado == "rejeita-se H0"  ~ "não paramétricos", resultado != "rejeita-se H0"  ~ "paramétricos" ))

m<- c %>% mutate( metodo = case_when(resultado == "rejeita-se H0" ~  "spearman", resultado != "rejeita-se H0"  ~ "pearson" ))
metodo<-m$metodo 

normalidade<-c$resultado

```
```{r}
a<-c(var(x=Temporario$Tmin,y=Temporario$FLO)) 
c<-c(cor(x=Temporario$Tmin,y=Temporario$FLO)^2)
d<-cor.test(y=Temporario$FLO, x=Temporario$Tmin, method=metodo) #pearson , spearman ou kendall
E<-data.frame("T. mínima" =c(a,d$estimate, c , normalidade , metodo , d$p.value))

Corre_min<-tableGrob(E)

```
```{r,  fig.align='center', out.width='100%', fig.asp=0.6, fig.width=9}

T_O_IRR<-grid.arrange(t_me, t_ma, t_mi, ncol=3)
Corre_IRR<-grid.arrange(Corre_est,Corre_med,Corre_max,Corre_min, ncol=4)
T_O_IRR
Corre_IRR
```
  
 A menor data de floração foi aos **`r Te[1,1]`** dias após a emergência, onde a temperatura média foi **`r Te[1,2]`****ºC**.   

### Irrigado tropical

Relação da temperatura média, máxima e mínima com a data de florecimento 
```{r, include=FALSE}
Temporario2<- TabelabrutaIRR %>% mutate( Clima= case_when(latitude < -29 ~ "subtropical", latitude > -30 ~ "tropical"))

Temporario<- Temporario2 %>% filter(Clima=="tropical") %>%  mutate( TMedia = ((Tmax_Media+Tmin_Media)/2)) %>% group_by(FLO) %>% summarise(TMedia = mean(TMedia)) %>% na.omit(Temporario)


 t_me<-ggplot(Temporario)+
  geom_point(aes(x=TMedia,y=FLO),Temporario, color= "blue")+
  geom_smooth(aes(x=TMedia,y=FLO), se= T, method='lm', color = "black")+
  labs(x="Temperatura média (ºC)", y="Data de florecimento (DAE)")+
  theme(plot.title = element_text(hjust = 0.5))
```

```{r , echo=FALSE}


    # teste de normalidade dos dados

b<-shapiro.test(Temporario$TMedia)
alfa<-0.05
c<- data.frame(c(b$p.value)) ; c<- c %>% mutate( resultado = case_when(c$c.b.p.value. <  alfa ~ "rejeita-se H0", c$c.b.p.value. > alfa ~ " não rejeita-se H0" , c$c.b.p.value. == alfa ~ " não rejeita-se H0" )) ; c<- c %>%  mutate( teste = case_when(resultado == "rejeita-se H0"  ~ "não paramétricos", resultado != "rejeita-se H0"  ~ "paramétricos" ))

m<- c %>% mutate( metodo = case_when(resultado == "rejeita-se H0" ~  "spearman", resultado != "rejeita-se H0"  ~ "pearson" ))
metodo<-m$metodo 

normalidade<-c$resultado 

```

```{r}
# Estatistica
 
a<-c(var(x=Temporario$TMedia,y=Temporario$FLO)) 
c<-c(cor(x=Temporario$TMedia,y=Temporario$FLO)^2)
d<-cor.test(y=Temporario$FLO, x=Temporario$TMedia, method= metodo) 
f<-data.frame("Estatística" =c("S²", "Cor", "r²","Teste Shapiro-Wilk", "Metodo", "Valor_P"))
E<-data.frame("T. média" =c(a,d$estimate, c ,normalidade, metodo, d$p.value ))
Corre_est<-tableGrob(f)
Corre_med<-tableGrob(E)


```

```{r}
tem<-sort(Temporario$FLO)
n<-tem[1]
Te<-subset(Temporario, FLO == n)
rm(tem,n)
```
 
```{r, include=FALSE }
Temporario<- Temporario2 %>% filter(Clima=="tropical") %>%  group_by(FLO) %>% summarise(Tmax = mean(Tmax_Media)) %>% na.omit(Temporario)


t_ma<-ggplot(Temporario)+
  geom_point(aes(x=Tmax,y=FLO),Temporario, color= "blue")+
  geom_smooth(aes(x=Tmax,y=FLO), se= T, method='lm', color = "black")+
  labs(x="Temperatura máxima (ºC)", y="Data de florecimento (DAE)" )+
  theme(plot.title = element_text(hjust = 0.5))

```

```{r , echo=FALSE}


    # teste de normalidade dos dados

b<-shapiro.test(Temporario$Tmax)
alfa<-0.05
c<- data.frame(c(b$p.value)) ; c<- c %>% mutate( resultado = case_when(c$c.b.p.value. <  alfa ~ "rejeita-se H0", c$c.b.p.value. > alfa ~ " não rejeita-se H0" , c$c.b.p.value. == alfa ~ " não rejeita-se H0" )) ; c<- c %>%  mutate( teste = case_when(resultado == "rejeita-se H0"  ~ "não paramétricos", resultado != "rejeita-se H0"  ~ "paramétricos" ))

m<- c %>% mutate( metodo = case_when(resultado == "rejeita-se H0" ~  "spearman", resultado != "rejeita-se H0"  ~ "pearson" ))
metodo<-m$metodo 

normalidade<-c$resultado 

```

```{r}

a<-c(var(x=Temporario$Tmax,y=Temporario$FLO)) 
c<-c(cor(x=Temporario$Tmax,y=Temporario$FLO)^2)
d<-cor.test(y=Temporario$FLO, x=Temporario$Tmax, method= metodo) 
E<-data.frame("T. máxima" =c(a,d$estimate, c , normalidade, metodo, d$p.value))

Corre_max<-tableGrob(E)
```

```{r, include=FALSE }
Temporario<- Temporario2 %>% filter(Clima=="tropical") %>%  group_by(FLO) %>% summarise(Tmin = mean(Tmin_Media)) %>% na.omit(Temporario)

t_mi<-ggplot(Temporario)+
  geom_point(aes(x=Tmin,y=FLO),Temporario, color= "blue")+
  geom_smooth(aes(x=Tmin,y=FLO), se= T, method='lm', color = "black")+
  labs(x="Temperatura mínima (ºC)", y="Data de florecimento (DAE)")+
  theme(plot.title = element_text(hjust = 0.5))
```
```{r , echo=FALSE}


    # teste de normalidade dos dados

b<-shapiro.test(Temporario$Tmin)
alfa<-0.05
c<- data.frame(c(b$p.value)) ; c<- c %>% mutate( resultado = case_when(c$c.b.p.value. <  alfa ~ "rejeita-se H0", c$c.b.p.value. > alfa ~ " não rejeita-se H0" , c$c.b.p.value. == alfa ~ " não rejeita-se H0" )) ; c<- c %>%  mutate( teste = case_when(resultado == "rejeita-se H0"  ~ "não paramétricos", resultado != "rejeita-se H0"  ~ "paramétricos" ))

m<- c %>% mutate( metodo = case_when(resultado == "rejeita-se H0" ~  "spearman", resultado != "rejeita-se H0"  ~ "pearson" ))
metodo<-m$metodo 

normalidade<-c$resultado

```
```{r}
a<-c(var(x=Temporario$Tmin,y=Temporario$FLO)) 
c<-c(cor(x=Temporario$Tmin,y=Temporario$FLO)^2)
d<-cor.test(y=Temporario$FLO, x=Temporario$Tmin, method=metodo) #pearson , spearman ou kendall
E<-data.frame("T. mínima" =c(a,d$estimate, c , normalidade , metodo , d$p.value))

Corre_min<-tableGrob(E)

```
```{r,  fig.align='center', out.width='100%', fig.asp=0.6, fig.width=9}
T_O_IRR<-grid.arrange(t_me, t_ma, t_mi, ncol=3)
Corre_IRR<-grid.arrange(Corre_est,Corre_med,Corre_max,Corre_min, ncol=4)
T_O_IRR
Corre_IRR
```
```{r , include=F}
rm(Temporario)
rm(a ,b,c,E)
rm(Corre_est,Corre_med,Corre_max,Corre_min, t_me, t_ma, t_mi)
```
  
 A menor data de floração foi aos **`r Te[1,1]`** dias após a emergência, onde a temperatura média foi **`r Te[1,2]`****ºC**.   