---
output:
  word_document: default
  html_document: default
---
# Determinação da temperatura ótima (Método 1)
  

  
```{r , include=F}
knitr::opts_chunk$set(warning = F, message = F)
```

```{r Diretório} 
# DIRETÓRIO DOS DADOS 


## Carregue estes dados antes de manipular os demais aquivos filhos:


Caminho_dos_dados <- file.path("C:","Users","Gutemberg","Desktop","Mestrado","Dados da Dicertação","Dados Brutos","Merge_1980_2018.csv")
Tabelabruta<- read.csv(Caminho_dos_dados, header = TRUE, sep = ";", stringsAsFactors = FALSE) # tabela com os dados originais

### Tabelas acessório
     
TabelabrutaIRR = subset(Tabelabruta, SIST_CULT == "IRRIGATED") # Irrigado
TabelabrutaTA = subset(Tabelabruta, SIST_CULT == "UPLAND") # Terras altas

```

```{r}

# Pacotes necessários para esta operação

if(!require(tidyverse))
  install.packages("tidyverse")
if(!require(gridExtra)) 
  install.packages("gridExtra")
```



  
## 1) Utilizando a média por genótipo
  
  Para esta análise foi calculado a média do florescimento (FLO), média da temperatura mínima média (Tmin_Media), média da  temperatura máxima média (Tmax_Media) e temperatura média (TMedia) para cada genótipo levando em consideração a latitude do ensaio. Consideramos a latitude pois alguns genótipos foram cultivados em mais de um local. (#Discutir isso com o orientador) 
  
```{r}

# Preparando os dados

mediasTA <- TabelabrutaTA  %>% group_by(GENOTIPO, latitude) %>% summarise(FLO_Medio = mean(FLO),Tmax_Media=	mean(Tmax_Media),Tmin_Media= mean(Tmin_Media)) #Dados do arroz terras altas

mediasIRR <- TabelabrutaIRR  %>% group_by(GENOTIPO, latitude) %>% summarise(FLO_Medio = mean(FLO),Tmax_Media=	mean(Tmax_Media),Tmin_Media= mean(Tmin_Media)) #Dados do arroz irrigado


```
  
### 1.1) Terras altas

 
```{r}
# criando a temperatura média e omitindo os NA.

Temporario <- mediasTA %>% mutate( TMedia = ((Tmax_Media+Tmin_Media)/2)) %>% group_by(FLO_Medio) %>% summarise(TMedia) %>% na.omit(Temporario) # obs.: essa etapa é diferente entre os itens 1,2 e 3.

# Plotando o florescimento pela temperatura média

 t_me<-ggplot(Temporario)+ 
  geom_point(aes(x=TMedia,y=FLO_Medio),Temporario, color= "#EA6E16")+
  geom_smooth(aes(x=TMedia,y=FLO_Medio), se= T, method='lm', color = "black")+
  labs(x="Temperatura média (ºC)", y="Data de florescimento (DAE)")+
  theme(plot.title = element_text(hjust = 0.5))
```
```{r}


    # teste de normalidade dos dados (Temperatura média)

b<-shapiro.test(Temporario$TMedia) # Teste Shapiro-Wilk
alfa<-0.05 # nivel de significancia 
c<- data.frame(c(b$p.value)) ; c<- c %>% mutate( resultado = case_when(c$c.b.p.value. <  alfa ~ "rejeita-se H0", c$c.b.p.value. > alfa ~ " não rejeita-se H0" , c$c.b.p.value. == alfa ~ " não rejeita-se H0" )) ; c<- c %>%  mutate( teste = case_when(resultado == "rejeita-se H0"  ~ "não paramétricos", resultado != "rejeita-se H0"  ~ "paramétricos" )) # Interpretação do p-valor do teste Shapiro-Wilk

m<- c %>% mutate( metodo = case_when(resultado == "rejeita-se H0" ~  "spearman", resultado != "rejeita-se H0"  ~ "pearson" )) # Escolha do método de correlação com base no teste Shapiro-Wilk
metodo<-m$metodo 

normalidade<-c$resultado 

```

```{r}
# Estatística
 
a<-c(var(x=Temporario$TMedia,y=Temporario$FLO_Medio)) # variância
c<-c(cor(x=Temporario$TMedia,y=Temporario$FLO_Medio)^2)# Coeficiente de determinação (r2)
d<-cor.test(y=Temporario$FLO_Medio, x=Temporario$TMedia, method= metodo) # Teste de correlação

# visualização dos resultados 

f<-data.frame("Estatística" =c("S²", "Cor", "r²","Teste Shapiro-Wilk", "Método", "Valor_P")) 
E<-data.frame("T. média" =c(a,d$estimate, c ,normalidade, metodo, d$p.value ))
Corre_est<-tableGrob(f)
Corre_med<-tableGrob(E)


```
```{r}
# Classsificação da menor data de florescimento e sua respectiva temperatura média

tem<-sort(Temporario$FLO_Medio)
n<-tem[1]
Te<-subset(Temporario, FLO_Medio == n)
rm(tem,n)
```

```{r}


Temporario<- mediasTA %>% group_by(FLO_Medio) %>% summarise(Tmax = Tmax_Media) %>% na.omit(Temporario) # obs.: essa etapa é diferente entre os itens 1,2 e 3. 

# Plotando o florescimento pela temperatura máxima

t_ma<-ggplot(Temporario)+
  geom_point(aes(x=Tmax,y=FLO_Medio),Temporario, color= "#EA6E16")+
  geom_smooth(aes(x=Tmax,y=FLO_Medio), se= T, method='lm', color = "black")+
  labs(x="Temperatura máxima (ºC)", y="Data de florescimento (DAE)" )+
  theme(plot.title = element_text(hjust = 0.5))
```
```{r }


    # teste de normalidade dos dados (Temperatura máxima)

b<-shapiro.test(Temporario$Tmax) # Teste Shapiro-Wilk
alfa<-0.05 # nível de significancia
c<- data.frame(c(b$p.value)) ; c<- c %>% mutate( resultado = case_when(c$c.b.p.value. <  alfa ~ "rejeita-se H0", c$c.b.p.value. > alfa ~ " não rejeita-se H0" , c$c.b.p.value. == alfa ~ " não rejeita-se H0" )) ; c<- c %>%  mutate( teste = case_when(resultado == "rejeita-se H0"  ~ "não paramétricos", resultado != "rejeita-se H0"  ~ "paramétricos" )) # interpretação do p-valor.

m<- c %>% mutate( metodo = case_when(resultado == "rejeita-se H0" ~  "spearman", resultado != "rejeita-se H0"  ~ "pearson" )) # escolha do método de correlação com base no teste Shapiro-Wilk
metodo<-m$metodo 

normalidade<-c$resultado 

```
```{r}

a<-c(var(x=Temporario$Tmax,y=Temporario$FLO_Medio)) # análise de variância  
c<-c(cor(x=Temporario$Tmax,y=Temporario$FLO_Medio)^2)# Coeficiente de correlação (r2)
d<-cor.test(y=Temporario$FLO_Medio, x=Temporario$Tmax, method= metodo) # teste de correlação
E<-data.frame("T. máxima" =c(a,d$estimate, c , normalidade, metodo, d$p.value)) # visualização dos resultados

Corre_max<-tableGrob(E)
```
```{r}

Temporario<- mediasTA %>% group_by(FLO_Medio) %>% summarise(Tmin = Tmin_Media) %>% na.omit(Temporario) # obs.: essa etapa é diferente entre os itens 1,2 e 3.

# Plotando o florescimento pela temperatura mínima

t_mi<-ggplot(Temporario)+
  geom_point(aes(x=Tmin,y=FLO_Medio),Temporario, color= "#EA6E16")+
  geom_smooth(aes(x=Tmin,y=FLO_Medio), se= T, method='lm', color = "black")+
  labs(x="Temperatura mínima (ºC)", y="Data de florescimento (DAE)")+
  theme(plot.title = element_text(hjust = 0.5))
```
```{r}


    # teste de normalidade dos dados

b<-shapiro.test(Temporario$Tmin)# Teste Shapiro-Wilk
alfa<-0.05# nível de significancia
c<- data.frame(c(b$p.value)) ; c<- c %>% mutate( resultado = case_when(c$c.b.p.value. <  alfa ~ "rejeita-se H0", c$c.b.p.value. > alfa ~ " não rejeita-se H0" , c$c.b.p.value. == alfa ~ " não rejeita-se H0" )) ; c<- c %>%  mutate( teste = case_when(resultado == "rejeita-se H0"  ~ "não paramétricos", resultado != "rejeita-se H0"  ~ "paramétricos" ))# interpretação do p-valor.

m<- c %>% mutate( metodo = case_when(resultado == "rejeita-se H0" ~  "spearman", resultado != "rejeita-se H0"  ~ "pearson" ))  # escolha do método de correlação com base no teste Shapiro-Wilk
metodo<-m$metodo 

normalidade<-c$resultado

```
```{r}
a<-c(var(x=Temporario$Tmin,y=Temporario$FLO_Medio)) # análise de variância
c<-c(cor(x=Temporario$Tmin,y=Temporario$FLO_Medio)^2)# Coeficiente de correlação (r2)
d<-cor.test(y=Temporario$FLO_Medio, x=Temporario$Tmin, method=metodo) # teste de correlação
E<-data.frame("T. mínima" =c(a,d$estimate, c , normalidade , metodo , d$p.value))

Corre_min<-tableGrob(E)

```
  
Relação da temperatura média, máxima e mínima com a data de florescimento 
```{r, fig.align='center', out.width='100%', fig.asp=0.6, fig.width=9}

# Visualização dos graficos e tabelas

T_O_TA<-grid.arrange(t_me, t_ma, t_mi, ncol=3)
Corre_TA<-grid.arrange(Corre_est,Corre_med,Corre_max,Corre_min, ncol=4)
```


  A menor data de floração foi aos **`r Te[1,1]`** dias após a emergência, onde a temperatura média foi **`r Te[1,2]`****ºC**. 

  

### 1.2) Irrigado
  

```{r}

Temporario<- mediasIRR %>% mutate( TMedia = ((Tmax_Media+Tmin_Media)/2)) %>% group_by(FLO_Medio) %>% summarise(TMedia) %>% na.omit(Temporario) # obs.: essa etapa é diferente entre os itens 1,2 e 3.

 t_me<-ggplot(Temporario)+
  geom_point(aes(x=TMedia,y=FLO_Medio),Temporario, color= "blue")+
  geom_smooth(aes(x=TMedia,y=FLO_Medio), se= T, method='lm', color = "black")+
  labs(x="Temperatura média (ºC)", y="Data de florescimento (DAE)")+
  theme(plot.title = element_text(hjust = 0.5))
```
```{r}


    # teste de normalidade dos dados

b<-shapiro.test(Temporario$TMedia)
alfa<-0.05
c<- data.frame(c(b$p.value)) ; c<- c %>% mutate( resultado = case_when(c$c.b.p.value. <  alfa ~ "rejeita-se H0", c$c.b.p.value. > alfa ~ " não rejeita-se H0" , c$c.b.p.value. == alfa ~ " não rejeita-se H0" )) ; c<- c %>%  mutate( teste = case_when(resultado == "rejeita-se H0"  ~ "não paramétricos", resultado != "rejeita-se H0"  ~ "paramétricos" ))

m<- c %>% mutate( metodo = case_when(resultado == "rejeita-se H0" ~  "spearman", resultado != "rejeita-se H0"  ~ "pearson" ))
metodo<-m$metodo 

normalidade<-c$resultado 

```

```{r}
# Estatística
 
a<-c(var(x=Temporario$TMedia,y=Temporario$FLO_Medio)) 
c<-c(cor(x=Temporario$TMedia,y=Temporario$FLO_Medio)^2)
d<-cor.test(y=Temporario$FLO_Medio, x=Temporario$TMedia, method= metodo) 
f<-data.frame("Estatística" =c("S²", "Cor", "r²","Teste Shapiro-Wilk", "Método", "Valor_P"))
E<-data.frame("T. média" =c(a,d$estimate, c ,normalidade, metodo, d$p.value ))
Corre_est<-tableGrob(f)
Corre_med<-tableGrob(E)


```

```{r}
tem<-sort(Temporario$FLO_Medio)
n<-tem[1]
Te<-subset(Temporario, FLO_Medio == n)
rm(tem,n)
```

```{r}

Temporario<- mediasIRR %>% group_by(FLO_Medio) %>% summarise(Tmax = Tmax_Media) %>% na.omit(Temporario) # obs.: essa etapa é diferente entre os itens 1,2 e 3.

t_ma<-ggplot(Temporario)+
  geom_point(aes(x=Tmax,y=FLO_Medio),Temporario, color= "blue")+
  geom_smooth(aes(x=Tmax,y=FLO_Medio), se= T, method='lm', color = "black")+
  labs(x="Temperatura máxima (ºC)", y="Data de florescimento (DAE)" )+
  theme(plot.title = element_text(hjust = 0.5))
```

```{r}


    # teste de normalidade dos dados

b<-shapiro.test(Temporario$Tmax)
alfa<-0.05
c<- data.frame(c(b$p.value)) ; c<- c %>% mutate( resultado = case_when(c$c.b.p.value. <  alfa ~ "rejeita-se H0", c$c.b.p.value. > alfa ~ " não rejeita-se H0" , c$c.b.p.value. == alfa ~ " não rejeita-se H0" )) ; c<- c %>%  mutate( teste = case_when(resultado == "rejeita-se H0"  ~ "não paramétricos", resultado != "rejeita-se H0"  ~ "paramétricos" ))

m<- c %>% mutate( metodo = case_when(resultado == "rejeita-se H0" ~  "spearman", resultado != "rejeita-se H0"  ~ "pearson" ))
metodo<-m$metodo 

normalidade<-c$resultado 

```

```{r}

a<-c(var(x=Temporario$Tmax,y=Temporario$FLO_Medio)) 
c<-c(cor(x=Temporario$Tmax,y=Temporario$FLO_Medio)^2)
d<-cor.test(y=Temporario$FLO_Medio, x=Temporario$Tmax, method= metodo) 
E<-data.frame("T. máxima" =c(a,d$estimate, c , normalidade, metodo, d$p.value))

Corre_max<-tableGrob(E)
```

```{r}
Temporario<- mediasIRR %>% group_by(FLO_Medio) %>% summarise(Tmin = Tmin_Media) %>% na.omit(Temporario) # obs.: essa etapa é diferente entre os itens 1,2 e 3.

t_mi<-ggplot(Temporario)+
  geom_point(aes(x=Tmin,y=FLO_Medio),Temporario, color= "blue")+
  geom_smooth(aes(x=Tmin,y=FLO_Medio), se= T, method='lm', color = "black")+
  labs(x="Temperatura mínima (ºC)", y="Data de florescimento (DAE)")+
  theme(plot.title = element_text(hjust = 0.5))

```
```{r}


    # teste de normalidade dos dados

b<-shapiro.test(Temporario$Tmin)
alfa<-0.05
c<- data.frame(c(b$p.value)) ; c<- c %>% mutate( resultado = case_when(c$c.b.p.value. <  alfa ~ "rejeita-se H0", c$c.b.p.value. > alfa ~ " não rejeita-se H0" , c$c.b.p.value. == alfa ~ " não rejeita-se H0" )) ; c<- c %>%  mutate( teste = case_when(resultado == "rejeita-se H0"  ~ "não paramétricos", resultado != "rejeita-se H0"  ~ "paramétricos" ))

m<- c %>% mutate( metodo = case_when(resultado == "rejeita-se H0" ~  "spearman", resultado != "rejeita-se H0"  ~ "pearson" ))
metodo<-m$metodo 

normalidade<-c$resultado

```
```{r}
a<-c(var(x=Temporario$Tmin,y=Temporario$FLO_Medio)) 
c<-c(cor(x=Temporario$Tmin,y=Temporario$FLO_Medio)^2)
d<-cor.test(y=Temporario$FLO_Medio, x=Temporario$Tmin, method=metodo) #pearson , spearman ou kendall
E<-data.frame("T. mínima" =c(a,d$estimate, c , normalidade , metodo , d$p.value))

Corre_min<-tableGrob(E)

```
  
Relação da temperatura média, máxima e mínima com a data de florescimento 
  
```{r, fig.align='center', out.width='100%', fig.asp=0.6, fig.width=9}
rm(Temporario)
T_O_IRR<-grid.arrange(t_me, t_ma, t_mi, ncol=3)
Corre_IRR<-grid.arrange(Corre_est,Corre_med,Corre_max,Corre_min, ncol=4)
```
  
   A menor data de floração foi aos **`r Te[1,1]`** dias após a emergência, onde a temperatura média foi **`r Te[1,2]`****ºC**. 
  
    
#### 1.2.1) Irrigado subtropical
  
```{r}
Temporario2<- mediasIRR %>% mutate( Clima= case_when(latitude <= -30 ~ "subtropical", latitude > -30 ~ "tropical")) # obs.: essa etapa é diferente entre os itens 1,2 e 3.

Temporario<- Temporario2 %>% filter(Clima=="subtropical") %>%  mutate( TMedia = ((Tmax_Media+Tmin_Media)/2)) %>% group_by(FLO_Medio) %>% summarise(TMedia) %>% na.omit(Temporario) 


 t_me<-ggplot(Temporario)+
  geom_point(aes(x=TMedia,y=FLO_Medio),Temporario, color= "blue")+
  geom_smooth(aes(x=TMedia,y=FLO_Medio), se= T, method='lm', color = "black")+
  labs(x="Temperatura média (ºC)", y="Data de florescimento (DAE)")+
  theme(plot.title = element_text(hjust = 0.5))
```

```{r}


    # teste de normalidade dos dados

b<-shapiro.test(Temporario$TMedia)
alfa<-0.05
c<- data.frame(c(b$p.value)) ; c<- c %>% mutate( resultado = case_when(c$c.b.p.value. <  alfa ~ "rejeita-se H0", c$c.b.p.value. > alfa ~ " não rejeita-se H0" , c$c.b.p.value. == alfa ~ " não rejeita-se H0" )) ; c<- c %>%  mutate( teste = case_when(resultado == "rejeita-se H0"  ~ "não paramétricos", resultado != "rejeita-se H0"  ~ "paramétricos" ))

m<- c %>% mutate( metodo = case_when(resultado == "rejeita-se H0" ~  "spearman", resultado != "rejeita-se H0"  ~ "pearson" ))
metodo<-m$metodo 

normalidade<-c$resultado 

```

```{r}
# Estatística
 
a<-c(var(x=Temporario$TMedia,y=Temporario$FLO_Medio)) 
c<-c(cor(x=Temporario$TMedia,y=Temporario$FLO_Medio)^2)
d<-cor.test(y=Temporario$FLO_Medio, x=Temporario$TMedia, method= metodo) 
f<-data.frame("Estatística" =c("S²", "Cor", "r²","Teste Shapiro-Wilk", "Método", "Valor_P"))
E<-data.frame("T. média" =c(a,d$estimate, c ,normalidade, metodo, d$p.value ))
Corre_est<-tableGrob(f)
Corre_med<-tableGrob(E)


```

```{r}
tem<-sort(Temporario$FLO_Medio)
n<-tem[1]
Te<-subset(Temporario, FLO_Medio == n)
rm(tem,n)
```

```{r}
Temporario<- Temporario2 %>% filter(Clima=="subtropical") %>%  group_by(FLO_Medio) %>% summarise(Tmax = Tmax_Media) %>% na.omit(Temporario) # obs.: essa etapa é diferente entre os itens 1,2 e 3.


t_ma<-ggplot(Temporario)+
  geom_point(aes(x=Tmax,y=FLO_Medio),Temporario, color= "blue")+
  geom_smooth(aes(x=Tmax,y=FLO_Medio), se= T, method='lm', color = "black")+
  labs(x="Temperatura máxima (ºC)", y="Data de florescimento (DAE)" )+
  theme(plot.title = element_text(hjust = 0.5))
```

```{r}


    # teste de normalidade dos dados

b<-shapiro.test(Temporario$Tmax)
alfa<-0.05
c<- data.frame(c(b$p.value)) ; c<- c %>% mutate( resultado = case_when(c$c.b.p.value. <  alfa ~ "rejeita-se H0", c$c.b.p.value. > alfa ~ " não rejeita-se H0" , c$c.b.p.value. == alfa ~ " não rejeita-se H0" )) ; c<- c %>%  mutate( teste = case_when(resultado == "rejeita-se H0"  ~ "não paramétricos", resultado != "rejeita-se H0"  ~ "paramétricos" ))

m<- c %>% mutate( metodo = case_when(resultado == "rejeita-se H0" ~  "spearman", resultado != "rejeita-se H0"  ~ "pearson" ))
metodo<-m$metodo 

normalidade<-c$resultado 

```

```{r}

a<-c(var(x=Temporario$Tmax,y=Temporario$FLO_Medio)) 
c<-c(cor(x=Temporario$Tmax,y=Temporario$FLO_Medio)^2)
d<-cor.test(y=Temporario$FLO_Medio, x=Temporario$Tmax, method= metodo) 
E<-data.frame("T. máxima" =c(a,d$estimate, c , normalidade, metodo, d$p.value))

Corre_max<-tableGrob(E)
```

```{r}
Temporario<- Temporario2 %>% filter(Clima=="subtropical") %>%  group_by(FLO_Medio) %>% summarise(Tmin = Tmin_Media) %>% na.omit(Temporario) # obs.: essa etapa é diferente entre os itens 1,2 e 3.

t_mi<-ggplot(Temporario)+
  geom_point(aes(x=Tmin,y=FLO_Medio),Temporario, color= "blue")+
  geom_smooth(aes(x=Tmin,y=FLO_Medio), se= T, method='lm', color = "black")+
  labs(x="Temperatura mínima (ºC)", y="Data de florescimento (DAE)")+
  theme(plot.title = element_text(hjust = 0.5))
```
```{r}


    # teste de normalidade dos dados

b<-shapiro.test(Temporario$Tmin)
alfa<-0.05
c<- data.frame(c(b$p.value)) ; c<- c %>% mutate( resultado = case_when(c$c.b.p.value. <  alfa ~ "rejeita-se H0", c$c.b.p.value. > alfa ~ " não rejeita-se H0" , c$c.b.p.value. == alfa ~ " não rejeita-se H0" )) ; c<- c %>%  mutate( teste = case_when(resultado == "rejeita-se H0"  ~ "não paramétricos", resultado != "rejeita-se H0"  ~ "paramétricos" ))

m<- c %>% mutate( metodo = case_when(resultado == "rejeita-se H0" ~  "spearman", resultado != "rejeita-se H0"  ~ "pearson" ))
metodo<-m$metodo 

normalidade<-c$resultado

```
```{r}
a<-c(var(x=Temporario$Tmin,y=Temporario$FLO_Medio)) 
c<-c(cor(x=Temporario$Tmin,y=Temporario$FLO_Medio)^2)
d<-cor.test(y=Temporario$FLO_Medio, x=Temporario$Tmin, method=metodo) #pearson , spearman ou kendall
E<-data.frame("T. mínima" =c(a,d$estimate, c , normalidade , metodo , d$p.value))

Corre_min<-tableGrob(E)

```
  
Relação da temperatura média, máxima e mínima com a data de florescimento 
  
```{r,  fig.align='center', out.width='100%', fig.asp=0.6, fig.width=9}

T_O_IRR<-grid.arrange(t_me, t_ma, t_mi, ncol=3)
Corre_IRR<-grid.arrange(Corre_est,Corre_med,Corre_max,Corre_min, ncol=4)
```
  
 A menor data de floração foi aos **`r Te[1,1]`** dias após a emergência, onde a temperatura média foi **`r Te[1,2]`****ºC**.   

#### 1.2.2) Irrigado tropical

```{r}
Temporario2<- mediasIRR %>% mutate( Clima= case_when(latitude <= -30 ~ "subtropical", latitude > -30 ~ "tropical")) # obs.: essa etapa é diferente entre os itens 1,2 e 3.

Temporario<- Temporario2 %>% filter(Clima=="tropical") %>%  mutate( TMedia = ((Tmax_Media+Tmin_Media)/2)) %>% group_by(FLO_Medio) %>% summarise(TMedia ) %>% na.omit(Temporario)


 t_me<-ggplot(Temporario)+
  geom_point(aes(x=TMedia,y=FLO_Medio),Temporario, color= "blue")+
  geom_smooth(aes(x=TMedia,y=FLO_Medio), se= T, method='lm', color = "black")+
  labs(x="Temperatura média (ºC)", y="Data de florescimento (DAE)")+
  theme(plot.title = element_text(hjust = 0.5))
```

```{r}


    # teste de normalidade dos dados

b<-shapiro.test(Temporario$TMedia)
alfa<-0.05
c<- data.frame(c(b$p.value)) ; c<- c %>% mutate( resultado = case_when(c$c.b.p.value. <  alfa ~ "rejeita-se H0", c$c.b.p.value. > alfa ~ " não rejeita-se H0" , c$c.b.p.value. == alfa ~ " não rejeita-se H0" )) ; c<- c %>%  mutate( teste = case_when(resultado == "rejeita-se H0"  ~ "não paramétricos", resultado != "rejeita-se H0"  ~ "paramétricos" ))

m<- c %>% mutate( metodo = case_when(resultado == "rejeita-se H0" ~  "spearman", resultado != "rejeita-se H0"  ~ "pearson" ))
metodo<-m$metodo 

normalidade<-c$resultado 

```

```{r}
# Estatística
 
a<-c(var(x=Temporario$TMedia,y=Temporario$FLO_Medio)) 
c<-c(cor(x=Temporario$TMedia,y=Temporario$FLO_Medio)^2)
d<-cor.test(y=Temporario$FLO_Medio, x=Temporario$TMedia, method= metodo) 
f<-data.frame("Estatística" =c("S²", "Cor", "r²","Teste Shapiro-Wilk", "Método", "Valor_P"))
E<-data.frame("T. média" =c(a,d$estimate, c ,normalidade, metodo, d$p.value ))
Corre_est<-tableGrob(f)
Corre_med<-tableGrob(E)


```

```{r}
tem<-sort(Temporario$FLO_Medio)
n<-tem[1]
Te<-subset(Temporario, FLO_Medio == n)
rm(tem,n)
```
 
```{r}
Temporario<- Temporario2 %>% filter(Clima=="tropical") %>%  group_by(FLO_Medio) %>% summarise(Tmax = Tmax_Media) %>% na.omit(Temporario) # obs.: essa etapa é diferente entre os itens 1,2 e 3.


t_ma<-ggplot(Temporario)+
  geom_point(aes(x=Tmax,y=FLO_Medio),Temporario, color= "blue")+
  geom_smooth(aes(x=Tmax,y=FLO_Medio), se= T, method='lm', color = "black")+
  labs(x="Temperatura máxima (ºC)", y="Data de florescimento (DAE)" )+
  theme(plot.title = element_text(hjust = 0.5))

```

```{r}


    # teste de normalidade dos dados

b<-shapiro.test(Temporario$Tmax)
alfa<-0.05
c<- data.frame(c(b$p.value)) ; c<- c %>% mutate( resultado = case_when(c$c.b.p.value. <  alfa ~ "rejeita-se H0", c$c.b.p.value. > alfa ~ " não rejeita-se H0" , c$c.b.p.value. == alfa ~ " não rejeita-se H0" )) ; c<- c %>%  mutate( teste = case_when(resultado == "rejeita-se H0"  ~ "não paramétricos", resultado != "rejeita-se H0"  ~ "paramétricos" ))

m<- c %>% mutate( metodo = case_when(resultado == "rejeita-se H0" ~  "spearman", resultado != "rejeita-se H0"  ~ "pearson" ))
metodo<-m$metodo 

normalidade<-c$resultado 

```

```{r}

a<-c(var(x=Temporario$Tmax,y=Temporario$FLO_Medio)) 
c<-c(cor(x=Temporario$Tmax,y=Temporario$FLO_Medio)^2)
d<-cor.test(y=Temporario$FLO_Medio, x=Temporario$Tmax, method= metodo) 
E<-data.frame("T. máxima" =c(a,d$estimate, c , normalidade, metodo, d$p.value))

Corre_max<-tableGrob(E)
```

```{r}
Temporario<- Temporario2 %>% filter(Clima=="tropical") %>%  group_by(FLO_Medio) %>% summarise(Tmin = Tmin_Media) %>% na.omit(Temporario) # obs.: essa etapa é diferente entre os itens 1,2 e 3.

t_mi<-ggplot(Temporario)+
  geom_point(aes(x=Tmin,y=FLO_Medio),Temporario, color= "blue")+
  geom_smooth(aes(x=Tmin,y=FLO_Medio), se= T, method='lm', color = "black")+
  labs(x="Temperatura mínima (ºC)", y="Data de florescimento (DAE)")+
  theme(plot.title = element_text(hjust = 0.5))
```
```{r}


    # teste de normalidade dos dados

b<-shapiro.test(Temporario$Tmin)
alfa<-0.05
c<- data.frame(c(b$p.value)) ; c<- c %>% mutate( resultado = case_when(c$c.b.p.value. <  alfa ~ "rejeita-se H0", c$c.b.p.value. > alfa ~ " não rejeita-se H0" , c$c.b.p.value. == alfa ~ " não rejeita-se H0" )) ; c<- c %>%  mutate( teste = case_when(resultado == "rejeita-se H0"  ~ "não paramétricos", resultado != "rejeita-se H0"  ~ "paramétricos" ))

m<- c %>% mutate( metodo = case_when(resultado == "rejeita-se H0" ~  "spearman", resultado != "rejeita-se H0"  ~ "pearson" ))
metodo<-m$metodo 

normalidade<-c$resultado

```
```{r}
a<-c(var(x=Temporario$Tmin,y=Temporario$FLO_Medio)) 
c<-c(cor(x=Temporario$Tmin,y=Temporario$FLO_Medio)^2)
d<-cor.test(y=Temporario$FLO_Medio, x=Temporario$Tmin, method=metodo) #pearson , spearman ou kendall
E<-data.frame("T. mínima" =c(a,d$estimate, c , normalidade , metodo , d$p.value))

Corre_min<-tableGrob(E)

```
  
Relação da temperatura média, máxima e mínima com a data de florescimento 
  
```{r,  fig.align='center', out.width='100%', fig.asp=0.6, fig.width=9}
T_O_IRR<-grid.arrange(t_me, t_ma, t_mi, ncol=3)
Corre_IRR<-grid.arrange(Corre_est,Corre_med,Corre_max,Corre_min, ncol=4)
```

  
 A menor data de floração foi aos **`r Te[1,1]`** dias após a emergência, onde a temperatura média foi **`r Te[1,2]`****ºC**.  


```{r}
rm(Temporario)
rm(a ,b,c,E)
rm(Corre_est,Corre_med,Corre_max,Corre_min, t_me, t_ma, t_mi)
```
  
  
  
## 2) Utilizando a média por ensaio 
  
     Para esta análise foi calculado a média do florescimento (FLO), média da temperatura mínima média (Tmin_Media), média da  temperatura máxima média (Tmax_Media) e temperatura média (TMedia) para cada ensaio.
  
```{r}

# Preparando os dados

mediasTA <- TabelabrutaTA  %>%  group_by(ID_ENSAIO, latitude) %>% summarise(	FLO_Media =	mean(FLO), Tmax_Media = mean(Tmax_Media),	Tmin_Media = mean(Tmin_Media))

mediasIRR <- TabelabrutaIRR  %>%  group_by(ID_ENSAIO, latitude) %>% summarise(	FLO_Media =	mean(FLO), Tmax_Media = mean(Tmax_Media),	Tmin_Media = mean(Tmin_Media))
```      
  
### 2.1) Terras altas

 
```{r}
Temporario <- mediasTA %>% mutate( TMedia = ((Tmax_Media+Tmin_Media)/2)) %>% group_by(FLO_Media) %>% summarise(TMedia) %>% na.omit(Temporario)

 t_me<-ggplot(Temporario)+
  geom_point(aes(x=TMedia,y=FLO_Media),Temporario, color= "#EA6E16")+
  geom_smooth(aes(x=TMedia,y=FLO_Media), se= T, method='lm', color = "black")+
  labs(x="Temperatura média (ºC)", y="Data de florescimento (DAE)")+
  theme(plot.title = element_text(hjust = 0.5))
```
```{r}


    # teste de normalidade dos dados

b<-shapiro.test(Temporario$TMedia)
alfa<-0.05
c<- data.frame(c(b$p.value)) ; c<- c %>% mutate( resultado = case_when(c$c.b.p.value. <  alfa ~ "rejeita-se H0", c$c.b.p.value. > alfa ~ " não rejeita-se H0" , c$c.b.p.value. == alfa ~ " não rejeita-se H0" )) ; c<- c %>%  mutate( teste = case_when(resultado == "rejeita-se H0"  ~ "não paramétricos", resultado != "rejeita-se H0"  ~ "paramétricos" ))

m<- c %>% mutate( metodo = case_when(resultado == "rejeita-se H0" ~  "spearman", resultado != "rejeita-se H0"  ~ "pearson" ))
metodo<-m$metodo 

normalidade<-c$resultado 

```

```{r}
# Estatística
 
a<-c(var(x=Temporario$TMedia,y=Temporario$FLO_Media)) 
c<-c(cor(x=Temporario$TMedia,y=Temporario$FLO_Media)^2)
d<-cor.test(y=Temporario$FLO_Media, x=Temporario$TMedia, method= metodo) 
f<-data.frame("Estatística" =c("S²", "Cor", "r²","Teste Shapiro-Wilk", "Método", "Valor_P"))
E<-data.frame("T. média" =c(a,d$estimate, c ,normalidade, metodo, d$p.value ))
Corre_est<-tableGrob(f)
Corre_med<-tableGrob(E)


```
```{r}
tem<-sort(Temporario$FLO_Media)
n<-tem[1]
Te<-subset(Temporario, FLO_Media == n)
rm(tem,n)
```

```{r}

Temporario<- mediasTA %>% group_by(FLO_Media) %>% summarise(Tmax = Tmax_Media) %>% na.omit(Temporario)

t_ma<-ggplot(Temporario)+
  geom_point(aes(x=Tmax,y=FLO_Media),Temporario, color= "#EA6E16")+
  geom_smooth(aes(x=Tmax,y=FLO_Media), se= T, method='lm', color = "black")+
  labs(x="Temperatura máxima (ºC)", y="Data de florescimento (DAE)" )+
  theme(plot.title = element_text(hjust = 0.5))
```
```{r}


    # teste de normalidade dos dados

b<-shapiro.test(Temporario$Tmax)
alfa<-0.05
c<- data.frame(c(b$p.value)) ; c<- c %>% mutate( resultado = case_when(c$c.b.p.value. <  alfa ~ "rejeita-se H0", c$c.b.p.value. > alfa ~ " não rejeita-se H0" , c$c.b.p.value. == alfa ~ " não rejeita-se H0" )) ; c<- c %>%  mutate( teste = case_when(resultado == "rejeita-se H0"  ~ "não paramétricos", resultado != "rejeita-se H0"  ~ "paramétricos" ))

m<- c %>% mutate( metodo = case_when(resultado == "rejeita-se H0" ~  "spearman", resultado != "rejeita-se H0"  ~ "pearson" ))
metodo<-m$metodo 

normalidade<-c$resultado 

```
```{r}

a<-c(var(x=Temporario$Tmax,y=Temporario$FLO_Media)) 
c<-c(cor(x=Temporario$Tmax,y=Temporario$FLO_Media)^2)
d<-cor.test(y=Temporario$FLO_Media, x=Temporario$Tmax, method= metodo) 
E<-data.frame("T. máxima" =c(a,d$estimate, c , normalidade, metodo, d$p.value))

Corre_max<-tableGrob(E)
```
```{r}
Temporario<- mediasTA %>% group_by(FLO_Media) %>% summarise(Tmin = Tmin_Media) %>% na.omit(Temporario)

t_mi<-ggplot(Temporario)+
  geom_point(aes(x=Tmin,y=FLO_Media),Temporario, color= "#EA6E16")+
  geom_smooth(aes(x=Tmin,y=FLO_Media), se= T, method='lm', color = "black")+
  labs(x="Temperatura mínima (ºC)", y="Data de florescimento (DAE)")+
  theme(plot.title = element_text(hjust = 0.5))
```
```{r}


    # teste de normalidade dos dados

b<-shapiro.test(Temporario$Tmin)
alfa<-0.05
c<- data.frame(c(b$p.value)) ; c<- c %>% mutate( resultado = case_when(c$c.b.p.value. <  alfa ~ "rejeita-se H0", c$c.b.p.value. > alfa ~ " não rejeita-se H0" , c$c.b.p.value. == alfa ~ " não rejeita-se H0" )) ; c<- c %>%  mutate( teste = case_when(resultado == "rejeita-se H0"  ~ "não paramétricos", resultado != "rejeita-se H0"  ~ "paramétricos" ))

m<- c %>% mutate( metodo = case_when(resultado == "rejeita-se H0" ~  "spearman", resultado != "rejeita-se H0"  ~ "pearson" ))
metodo<-m$metodo 

normalidade<-c$resultado

```
```{r}
a<-c(var(x=Temporario$Tmin,y=Temporario$FLO_Media)) 
c<-c(cor(x=Temporario$Tmin,y=Temporario$FLO_Media)^2)
d<-cor.test(y=Temporario$FLO_Media, x=Temporario$Tmin, method=metodo) #pearson , spearman ou kendall
E<-data.frame("T. mínima" =c(a,d$estimate, c , normalidade , metodo , d$p.value))

Corre_min<-tableGrob(E)

```
  
Relação da temperatura média, máxima e mínima com a data de florescimento 
  
```{r, fig.align='center', out.width='100%', fig.asp=0.6, fig.width=9}

T_O_TA<-grid.arrange(t_me, t_ma, t_mi, ncol=3)
Corre_TA<-grid.arrange(Corre_est,Corre_med,Corre_max,Corre_min, ncol=4)
```


  A menor data de floração foi aos **`r Te[1,1]`** dias após a emergência, onde a temperatura média foi **`r Te[1,2]`****ºC**. 

  

### 2.2) Irrigado
  
```{r}

Temporario<- mediasIRR %>% mutate( TMedia = ((Tmax_Media+Tmin_Media)/2)) %>% group_by(FLO_Media) %>% summarise(TMedia) %>% na.omit(Temporario)

 t_me<-ggplot(Temporario)+
  geom_point(aes(x=TMedia,y=FLO_Media),Temporario, color= "blue")+
  geom_smooth(aes(x=TMedia,y=FLO_Media), se= T, method='lm', color = "black")+
  labs(x="Temperatura média (ºC)", y="Data de florescimento (DAE)")+
  theme(plot.title = element_text(hjust = 0.5))
```
```{r}


    # teste de normalidade dos dados

b<-shapiro.test(Temporario$TMedia)
alfa<-0.05
c<- data.frame(c(b$p.value)) ; c<- c %>% mutate( resultado = case_when(c$c.b.p.value. <  alfa ~ "rejeita-se H0", c$c.b.p.value. > alfa ~ " não rejeita-se H0" , c$c.b.p.value. == alfa ~ " não rejeita-se H0" )) ; c<- c %>%  mutate( teste = case_when(resultado == "rejeita-se H0"  ~ "não paramétricos", resultado != "rejeita-se H0"  ~ "paramétricos" ))

m<- c %>% mutate( metodo = case_when(resultado == "rejeita-se H0" ~  "spearman", resultado != "rejeita-se H0"  ~ "pearson" ))
metodo<-m$metodo 

normalidade<-c$resultado 

```

```{r}
# Estatística
 
a<-c(var(x=Temporario$TMedia,y=Temporario$FLO_Media)) 
c<-c(cor(x=Temporario$TMedia,y=Temporario$FLO_Media)^2)
d<-cor.test(y=Temporario$FLO_Media, x=Temporario$TMedia, method= metodo) 
f<-data.frame("Estatística" =c("S²", "Cor", "r²","Teste Shapiro-Wilk", "Método", "Valor_P"))
E<-data.frame("T. média" =c(a,d$estimate, c ,normalidade, metodo, d$p.value ))
Corre_est<-tableGrob(f)
Corre_med<-tableGrob(E)


```

```{r}
tem<-sort(Temporario$FLO_Media)
n<-tem[1]
Te<-subset(Temporario, FLO_Media == n)
rm(tem,n)
```

```{r}

Temporario<- mediasIRR %>% group_by(FLO_Media) %>% summarise(Tmax = Tmax_Media) %>% na.omit(Temporario)

t_ma<-ggplot(Temporario)+
  geom_point(aes(x=Tmax,y=FLO_Media),Temporario, color= "blue")+
  geom_smooth(aes(x=Tmax,y=FLO_Media), se= T, method='lm', color = "black")+
  labs(x="Temperatura máxima (ºC)", y="Data de florescimento (DAE)" )+
  theme(plot.title = element_text(hjust = 0.5))
```

```{r}


    # teste de normalidade dos dados

b<-shapiro.test(Temporario$Tmax)
alfa<-0.05
c<- data.frame(c(b$p.value)) ; c<- c %>% mutate( resultado = case_when(c$c.b.p.value. <  alfa ~ "rejeita-se H0", c$c.b.p.value. > alfa ~ " não rejeita-se H0" , c$c.b.p.value. == alfa ~ " não rejeita-se H0" )) ; c<- c %>%  mutate( teste = case_when(resultado == "rejeita-se H0"  ~ "não paramétricos", resultado != "rejeita-se H0"  ~ "paramétricos" ))

m<- c %>% mutate( metodo = case_when(resultado == "rejeita-se H0" ~  "spearman", resultado != "rejeita-se H0"  ~ "pearson" ))
metodo<-m$metodo 

normalidade<-c$resultado 

```

```{r}

a<-c(var(x=Temporario$Tmax,y=Temporario$FLO_Media)) 
c<-c(cor(x=Temporario$Tmax,y=Temporario$FLO_Media)^2)
d<-cor.test(y=Temporario$FLO_Media, x=Temporario$Tmax, method= metodo) 
E<-data.frame("T. máxima" =c(a,d$estimate, c , normalidade, metodo, d$p.value))

Corre_max<-tableGrob(E)
```

```{r}
Temporario<- mediasIRR %>% group_by(FLO_Media) %>% summarise(Tmin = Tmin_Media) %>% na.omit(Temporario)

t_mi<-ggplot(Temporario)+
  geom_point(aes(x=Tmin,y=FLO_Media),Temporario, color= "blue")+
  geom_smooth(aes(x=Tmin,y=FLO_Media), se= T, method='lm', color = "black")+
  labs(x="Temperatura mínima (ºC)", y="Data de florescimento (DAE)")+
  theme(plot.title = element_text(hjust = 0.5))

```
```{r}


    # teste de normalidade dos dados

b<-shapiro.test(Temporario$Tmin)
alfa<-0.05
c<- data.frame(c(b$p.value)) ; c<- c %>% mutate( resultado = case_when(c$c.b.p.value. <  alfa ~ "rejeita-se H0", c$c.b.p.value. > alfa ~ " não rejeita-se H0" , c$c.b.p.value. == alfa ~ " não rejeita-se H0" )) ; c<- c %>%  mutate( teste = case_when(resultado == "rejeita-se H0"  ~ "não paramétricos", resultado != "rejeita-se H0"  ~ "paramétricos" ))

m<- c %>% mutate( metodo = case_when(resultado == "rejeita-se H0" ~  "spearman", resultado != "rejeita-se H0"  ~ "pearson" ))
metodo<-m$metodo 

normalidade<-c$resultado

```
```{r}
a<-c(var(x=Temporario$Tmin,y=Temporario$FLO_Media)) 
c<-c(cor(x=Temporario$Tmin,y=Temporario$FLO_Media)^2)
d<-cor.test(y=Temporario$FLO_Media, x=Temporario$Tmin, method=metodo) #pearson , spearman ou kendall
E<-data.frame("T. mínima" =c(a,d$estimate, c , normalidade , metodo , d$p.value))

Corre_min<-tableGrob(E)

```
  
Relação da temperatura média, máxima e mínima com a data de florescimento 
    

```{r,fig.align='center', out.width='100%', fig.asp=0.6, fig.width=9}
rm(Temporario)
T_O_IRR<-grid.arrange(t_me, t_ma, t_mi, ncol=3)
Corre_IRR<-grid.arrange(Corre_est,Corre_med,Corre_max,Corre_min, ncol=4)
```
  
   A menor data de floração foi aos **`r Te[1,1]`** dias após a emergência, onde a temperatura média foi **`r Te[1,2]`****ºC**. 
  
    
#### 2.2.1) Irrigado subtropical
  
```{r}
Temporario2<- mediasIRR %>% mutate( Clima= case_when(latitude <= -30 ~ "subtropical", latitude > -30 ~ "tropical"))

Temporario<- Temporario2 %>% filter(Clima=="subtropical") %>%  mutate( TMedia = ((Tmax_Media+Tmin_Media)/2)) %>% group_by(FLO_Media) %>% summarise(TMedia) %>% na.omit(Temporario)


 t_me<-ggplot(Temporario)+
  geom_point(aes(x=TMedia,y=FLO_Media),Temporario, color= "blue")+
  geom_smooth(aes(x=TMedia,y=FLO_Media), se= T, method='lm', color = "black")+
  labs(x="Temperatura média (ºC)", y="Data de florescimento (DAE)")+
  theme(plot.title = element_text(hjust = 0.5))
```

```{r}


    # teste de normalidade dos dados

b<-shapiro.test(Temporario$TMedia)
alfa<-0.05
c<- data.frame(c(b$p.value)) ; c<- c %>% mutate( resultado = case_when(c$c.b.p.value. <  alfa ~ "rejeita-se H0", c$c.b.p.value. > alfa ~ " não rejeita-se H0" , c$c.b.p.value. == alfa ~ " não rejeita-se H0" )) ; c<- c %>%  mutate( teste = case_when(resultado == "rejeita-se H0"  ~ "não paramétricos", resultado != "rejeita-se H0"  ~ "paramétricos" ))

m<- c %>% mutate( metodo = case_when(resultado == "rejeita-se H0" ~  "spearman", resultado != "rejeita-se H0"  ~ "pearson" ))
metodo<-m$metodo 

normalidade<-c$resultado 

```

```{r}
# Estatística
 
a<-c(var(x=Temporario$TMedia,y=Temporario$FLO_Media)) 
c<-c(cor(x=Temporario$TMedia,y=Temporario$FLO_Media)^2)
d<-cor.test(y=Temporario$FLO_Media, x=Temporario$TMedia, method= metodo) 
f<-data.frame("Estatística" =c("S²", "Cor", "r²","Teste Shapiro-Wilk", "Método", "Valor_P"))
E<-data.frame("T. média" =c(a,d$estimate, c ,normalidade, metodo, d$p.value ))
Corre_est<-tableGrob(f)
Corre_med<-tableGrob(E)


```

```{r}
tem<-sort(Temporario$FLO_Media)
n<-tem[1]
Te<-subset(Temporario, FLO_Media == n)
rm(tem,n)
```

```{r}
Temporario<- Temporario2 %>% filter(Clima=="subtropical") %>%  group_by(FLO_Media) %>% summarise(Tmax = Tmax_Media) %>% na.omit(Temporario)


t_ma<-ggplot(Temporario)+
  geom_point(aes(x=Tmax,y=FLO_Media),Temporario, color= "blue")+
  geom_smooth(aes(x=Tmax,y=FLO_Media), se= T, method='lm', color = "black")+
  labs(x="Temperatura máxima (ºC)", y="Data de florescimento (DAE)" )+
  theme(plot.title = element_text(hjust = 0.5))
```

```{r}


    # teste de normalidade dos dados

b<-shapiro.test(Temporario$Tmax)
alfa<-0.05
c<- data.frame(c(b$p.value)) ; c<- c %>% mutate( resultado = case_when(c$c.b.p.value. <  alfa ~ "rejeita-se H0", c$c.b.p.value. > alfa ~ " não rejeita-se H0" , c$c.b.p.value. == alfa ~ " não rejeita-se H0" )) ; c<- c %>%  mutate( teste = case_when(resultado == "rejeita-se H0"  ~ "não paramétricos", resultado != "rejeita-se H0"  ~ "paramétricos" ))

m<- c %>% mutate( metodo = case_when(resultado == "rejeita-se H0" ~  "spearman", resultado != "rejeita-se H0"  ~ "pearson" ))
metodo<-m$metodo 

normalidade<-c$resultado 

```

```{r}

a<-c(var(x=Temporario$Tmax,y=Temporario$FLO_Media)) 
c<-c(cor(x=Temporario$Tmax,y=Temporario$FLO_Media)^2)
d<-cor.test(y=Temporario$FLO_Media, x=Temporario$Tmax, method= metodo) 
E<-data.frame("T. máxima" =c(a,d$estimate, c , normalidade, metodo, d$p.value))

Corre_max<-tableGrob(E)
```

```{r}
Temporario<- Temporario2 %>% filter(Clima=="subtropical") %>%  group_by(FLO_Media) %>% summarise(Tmin = Tmin_Media) %>% na.omit(Temporario)

t_mi<-ggplot(Temporario)+
  geom_point(aes(x=Tmin,y=FLO_Media),Temporario, color= "blue")+
  geom_smooth(aes(x=Tmin,y=FLO_Media), se= T, method='lm', color = "black")+
  labs(x="Temperatura mínima (ºC)", y="Data de florescimento (DAE)")+
  theme(plot.title = element_text(hjust = 0.5))
```
```{r}


    # teste de normalidade dos dados

b<-shapiro.test(Temporario$Tmin)
alfa<-0.05
c<- data.frame(c(b$p.value)) ; c<- c %>% mutate( resultado = case_when(c$c.b.p.value. <  alfa ~ "rejeita-se H0", c$c.b.p.value. > alfa ~ " não rejeita-se H0" , c$c.b.p.value. == alfa ~ " não rejeita-se H0" )) ; c<- c %>%  mutate( teste = case_when(resultado == "rejeita-se H0"  ~ "não paramétricos", resultado != "rejeita-se H0"  ~ "paramétricos" ))

m<- c %>% mutate( metodo = case_when(resultado == "rejeita-se H0" ~  "spearman", resultado != "rejeita-se H0"  ~ "pearson" ))
metodo<-m$metodo 

normalidade<-c$resultado

```
```{r}
a<-c(var(x=Temporario$Tmin,y=Temporario$FLO_Media)) 
c<-c(cor(x=Temporario$Tmin,y=Temporario$FLO_Media)^2)
d<-cor.test(y=Temporario$FLO_Media, x=Temporario$Tmin, method=metodo) #pearson , spearman ou kendall
E<-data.frame("T. mínima" =c(a,d$estimate, c , normalidade , metodo , d$p.value))

Corre_min<-tableGrob(E)

```
  
Relação da temperatura média, máxima e mínima com a data de florescimento 
  
```{r,  fig.align='center', out.width='100%', fig.asp=0.6, fig.width=9}

T_O_IRR<-grid.arrange(t_me, t_ma, t_mi, ncol=3)
Corre_IRR<-grid.arrange(Corre_est,Corre_med,Corre_max,Corre_min, ncol=4)
```
  
 A menor data de floração foi aos **`r Te[1,1]`** dias após a emergência, onde a temperatura média foi **`r Te[1,2]`****ºC**.   

#### 2.2.2) Irrigado tropical

```{r}
Temporario2<- mediasIRR %>% mutate( Clima= case_when(latitude <= -30 ~ "subtropical", latitude > -30 ~ "tropical"))

Temporario<- Temporario2 %>% filter(Clima=="tropical") %>%  mutate( TMedia = ((Tmax_Media+Tmin_Media)/2)) %>% group_by(FLO_Media) %>% summarise(TMedia ) %>% na.omit(Temporario)


 t_me<-ggplot(Temporario)+
  geom_point(aes(x=TMedia,y=FLO_Media),Temporario, color= "blue")+
  geom_smooth(aes(x=TMedia,y=FLO_Media), se= T, method='lm', color = "black")+
  labs(x="Temperatura média (ºC)", y="Data de florescimento (DAE)")+
  theme(plot.title = element_text(hjust = 0.5))
```

```{r}


    # teste de normalidade dos dados

b<-shapiro.test(Temporario$TMedia)
alfa<-0.05
c<- data.frame(c(b$p.value)) ; c<- c %>% mutate( resultado = case_when(c$c.b.p.value. <  alfa ~ "rejeita-se H0", c$c.b.p.value. > alfa ~ " não rejeita-se H0" , c$c.b.p.value. == alfa ~ " não rejeita-se H0" )) ; c<- c %>%  mutate( teste = case_when(resultado == "rejeita-se H0"  ~ "não paramétricos", resultado != "rejeita-se H0"  ~ "paramétricos" ))

m<- c %>% mutate( metodo = case_when(resultado == "rejeita-se H0" ~  "spearman", resultado != "rejeita-se H0"  ~ "pearson" ))
metodo<-m$metodo 

normalidade<-c$resultado 

```

```{r}
# Estatística
 
a<-c(var(x=Temporario$TMedia,y=Temporario$FLO_Media)) 
c<-c(cor(x=Temporario$TMedia,y=Temporario$FLO_Media)^2)
d<-cor.test(y=Temporario$FLO_Media, x=Temporario$TMedia, method= metodo) 
f<-data.frame("Estatística" =c("S²", "Cor", "r²","Teste Shapiro-Wilk", "Método", "Valor_P"))
E<-data.frame("T. média" =c(a,d$estimate, c ,normalidade, metodo, d$p.value ))
Corre_est<-tableGrob(f)
Corre_med<-tableGrob(E)


```

```{r}
tem<-sort(Temporario$FLO_Media)
n<-tem[1]
Te<-subset(Temporario, FLO_Media == n)
rm(tem,n)
```
 
```{r}
Temporario<- Temporario2 %>% filter(Clima=="tropical") %>%  group_by(FLO_Media) %>% summarise(Tmax = Tmax_Media) %>% na.omit(Temporario)


t_ma<-ggplot(Temporario)+
  geom_point(aes(x=Tmax,y=FLO_Media),Temporario, color= "blue")+
  geom_smooth(aes(x=Tmax,y=FLO_Media), se= T, method='lm', color = "black")+
  labs(x="Temperatura máxima (ºC)", y="Data de florescimento (DAE)" )+
  theme(plot.title = element_text(hjust = 0.5))

```

```{r}


    # teste de normalidade dos dados

b<-shapiro.test(Temporario$Tmax)
alfa<-0.05
c<- data.frame(c(b$p.value)) ; c<- c %>% mutate( resultado = case_when(c$c.b.p.value. <  alfa ~ "rejeita-se H0", c$c.b.p.value. > alfa ~ " não rejeita-se H0" , c$c.b.p.value. == alfa ~ " não rejeita-se H0" )) ; c<- c %>%  mutate( teste = case_when(resultado == "rejeita-se H0"  ~ "não paramétricos", resultado != "rejeita-se H0"  ~ "paramétricos" ))

m<- c %>% mutate( metodo = case_when(resultado == "rejeita-se H0" ~  "spearman", resultado != "rejeita-se H0"  ~ "pearson" ))
metodo<-m$metodo 

normalidade<-c$resultado 

```

```{r}

a<-c(var(x=Temporario$Tmax,y=Temporario$FLO_Media)) 
c<-c(cor(x=Temporario$Tmax,y=Temporario$FLO_Media)^2)
d<-cor.test(y=Temporario$FLO_Media, x=Temporario$Tmax, method= metodo) 
E<-data.frame("T. máxima" =c(a,d$estimate, c , normalidade, metodo, d$p.value))

Corre_max<-tableGrob(E)
```

```{r}
Temporario<- Temporario2 %>% filter(Clima=="tropical") %>%  group_by(FLO_Media) %>% summarise(Tmin = Tmin_Media) %>% na.omit(Temporario)

t_mi<-ggplot(Temporario)+
  geom_point(aes(x=Tmin,y=FLO_Media),Temporario, color= "blue")+
  geom_smooth(aes(x=Tmin,y=FLO_Media), se= T, method='lm', color = "black")+
  labs(x="Temperatura mínima (ºC)", y="Data de florescimento (DAE)")+
  theme(plot.title = element_text(hjust = 0.5))
```
```{r}


    # teste de normalidade dos dados

b<-shapiro.test(Temporario$Tmin)
alfa<-0.05
c<- data.frame(c(b$p.value)) ; c<- c %>% mutate( resultado = case_when(c$c.b.p.value. <  alfa ~ "rejeita-se H0", c$c.b.p.value. > alfa ~ " não rejeita-se H0" , c$c.b.p.value. == alfa ~ " não rejeita-se H0" )) ; c<- c %>%  mutate( teste = case_when(resultado == "rejeita-se H0"  ~ "não paramétricos", resultado != "rejeita-se H0"  ~ "paramétricos" ))

m<- c %>% mutate( metodo = case_when(resultado == "rejeita-se H0" ~  "spearman", resultado != "rejeita-se H0"  ~ "pearson" ))
metodo<-m$metodo 

normalidade<-c$resultado

```
```{r}
a<-c(var(x=Temporario$Tmin,y=Temporario$FLO_Media)) 
c<-c(cor(x=Temporario$Tmin,y=Temporario$FLO_Media)^2)
d<-cor.test(y=Temporario$FLO_Media, x=Temporario$Tmin, method=metodo) #pearson , spearman ou kendall
E<-data.frame("T. mínima" =c(a,d$estimate, c , normalidade , metodo , d$p.value))

Corre_min<-tableGrob(E)

```
  
Relação da temperatura média, máxima e mínima com a data de florescimento 
    
```{r,  fig.align='center', out.width='100%', fig.asp=0.6, fig.width=9}
T_O_IRR<-grid.arrange(t_me, t_ma, t_mi, ncol=3)
Corre_IRR<-grid.arrange(Corre_est,Corre_med,Corre_max,Corre_min, ncol=4)
```

  
 A menor data de floração foi aos **`r Te[1,1]`** dias após a emergência, onde a temperatura média foi **`r Te[1,2]`****ºC**.   
 
```{r}
rm(Temporario)
rm(a ,b,c,E)
rm(Corre_est,Corre_med,Corre_max,Corre_min, t_me, t_ma, t_mi)
```
  
    
      
## 3) Utilizando a média das temperaturas pela floração
  
    
      
  

 Para esta análise foram calculados a  média da temperatura mínima média (Tmin_Media), média da  temperatura máxima média (Tmax_Media) e temperatura média (TMedia) para cada data de florescimento, não levando em consideração o genótipo ou o ensaio. (#Discutir isso com o orientador)
  
### 3.1) Terras altas

 
```{r }


Temporario <- TabelabrutaTA %>% mutate( TMedia = ((Tmax_Media+Tmin_Media)/2)) %>% group_by(FLO) %>% summarise(TMedia = mean(TMedia)) %>% na.omit(Temporario)

 t_me<-ggplot(Temporario)+
  geom_point(aes(x=TMedia,y=FLO),Temporario, color= "#EA6E16")+
  geom_smooth(aes(x=TMedia,y=FLO), se= T, method='lm', color = "black")+
  labs(x="Temperatura média (ºC)", y="Data de florescimento (DAE)")+
  theme(plot.title = element_text(hjust = 0.5))
```
```{r}


    # teste de normalidade dos dados

b<-shapiro.test(Temporario$TMedia)
alfa<-0.05
c<- data.frame(c(b$p.value)) ; c<- c %>% mutate( resultado = case_when(c$c.b.p.value. <  alfa ~ "rejeita-se H0", c$c.b.p.value. > alfa ~ " não rejeita-se H0" , c$c.b.p.value. == alfa ~ " não rejeita-se H0" )) ; c<- c %>%  mutate( teste = case_when(resultado == "rejeita-se H0"  ~ "não paramétricos", resultado != "rejeita-se H0"  ~ "paramétricos" ))

m<- c %>% mutate( metodo = case_when(resultado == "rejeita-se H0" ~  "spearman", resultado != "rejeita-se H0"  ~ "pearson" ))
metodo<-m$metodo 

normalidade<-c$resultado 

```

```{r}
# Estatística
 
a<-c(var(x=Temporario$TMedia,y=Temporario$FLO)) 
c<-c(cor(x=Temporario$TMedia,y=Temporario$FLO)^2)
d<-cor.test(y=Temporario$FLO, x=Temporario$TMedia, method= metodo) 
f<-data.frame("Estatística" =c("S²", "Cor", "r²","Teste Shapiro-Wilk", "Método", "Valor_P"))
E<-data.frame("T. média" =c(a,d$estimate, c ,normalidade, metodo, d$p.value ))
Corre_est<-tableGrob(f)
Corre_med<-tableGrob(E)


```
```{r}
tem<-sort(Temporario$FLO)
n<-tem[1]
Te<-subset(Temporario, FLO == n)
rm(tem,n)
```

```{r}

Temporario<- TabelabrutaTA %>% group_by(FLO) %>% summarise(Tmax = mean(Tmax_Media)) %>% na.omit(Temporario)

t_ma<-ggplot(Temporario)+
  geom_point(aes(x=Tmax,y=FLO),Temporario, color= "#EA6E16")+
  geom_smooth(aes(x=Tmax,y=FLO), se= T, method='lm', color = "black")+
  labs(x="Temperatura máxima (ºC)", y="Data de florescimento (DAE)" )+
  theme(plot.title = element_text(hjust = 0.5))
```
```{r}


    # teste de normalidade dos dados

b<-shapiro.test(Temporario$Tmax)
alfa<-0.05
c<- data.frame(c(b$p.value)) ; c<- c %>% mutate( resultado = case_when(c$c.b.p.value. <  alfa ~ "rejeita-se H0", c$c.b.p.value. > alfa ~ " não rejeita-se H0" , c$c.b.p.value. == alfa ~ " não rejeita-se H0" )) ; c<- c %>%  mutate( teste = case_when(resultado == "rejeita-se H0"  ~ "não paramétricos", resultado != "rejeita-se H0"  ~ "paramétricos" ))

m<- c %>% mutate( metodo = case_when(resultado == "rejeita-se H0" ~  "spearman", resultado != "rejeita-se H0"  ~ "pearson" ))
metodo<-m$metodo 

normalidade<-c$resultado 

```
```{r}

a<-c(var(x=Temporario$Tmax,y=Temporario$FLO)) 
c<-c(cor(x=Temporario$Tmax,y=Temporario$FLO)^2)
d<-cor.test(y=Temporario$FLO, x=Temporario$Tmax, method= metodo) 
E<-data.frame("T. máxima" =c(a,d$estimate, c , normalidade, metodo, d$p.value))

Corre_max<-tableGrob(E)
```
```{r}
Temporario<- TabelabrutaTA %>% group_by(FLO) %>% summarise(Tmin = mean(Tmin_Media)) %>% na.omit(Temporario)

t_mi<-ggplot(Temporario)+
  geom_point(aes(x=Tmin,y=FLO),Temporario, color= "#EA6E16")+
  geom_smooth(aes(x=Tmin,y=FLO), se= T, method='lm', color = "black")+
  labs(x="Temperatura mínima (ºC)", y="Data de florescimento (DAE)")+
  theme(plot.title = element_text(hjust = 0.5))
```
```{r}
    # teste de normalidade dos dados

b<-shapiro.test(Temporario$Tmin)
alfa<-0.05
c<- data.frame(c(b$p.value)) ; c<- c %>% mutate( resultado = case_when(c$c.b.p.value. <  alfa ~ "rejeita-se H0", c$c.b.p.value. > alfa ~ " não rejeita-se H0" , c$c.b.p.value. == alfa ~ " não rejeita-se H0" )) ; c<- c %>%  mutate( teste = case_when(resultado == "rejeita-se H0"  ~ "não paramétricos", resultado != "rejeita-se H0"  ~ "paramétricos" ))

m<- c %>% mutate( metodo = case_when(resultado == "rejeita-se H0" ~  "spearman", resultado != "rejeita-se H0"  ~ "pearson" ))
metodo<-m$metodo 

normalidade<-c$resultado

```
```{r}
a<-c(var(x=Temporario$Tmin,y=Temporario$FLO)) 
c<-c(cor(x=Temporario$Tmin,y=Temporario$FLO)^2)
d<-cor.test(y=Temporario$FLO, x=Temporario$Tmin, method=metodo) #pearson , spearman ou kendall
E<-data.frame("T. mínima" =c(a,d$estimate, c , normalidade , metodo , d$p.value))

Corre_min<-tableGrob(E)

```
  
Relação da temperatura média, máxima e mínima com a data de florescimento   
  
```{r, fig.align='center', out.width='100%', fig.asp=0.6, fig.width=9}

T_O_TA<-grid.arrange(t_me, t_ma, t_mi, ncol=3)
Corre_TA<-grid.arrange(Corre_est,Corre_med,Corre_max,Corre_min, ncol=4)
```


  A menor data de floração foi aos **`r Te[1,1]`** dias após a emergência, onde a temperatura média foi **`r Te[1,2]`****ºC**. 

  

### 3.2) Irrigado
  

```{r}

Temporario<- TabelabrutaIRR %>% mutate( TMedia = ((Tmax_Media+Tmin_Media)/2)) %>% group_by(FLO) %>% summarise(TMedia = mean(TMedia)) %>% na.omit(Temporario)

 t_me<-ggplot(Temporario)+
  geom_point(aes(x=TMedia,y=FLO),Temporario, color= "blue")+
  geom_smooth(aes(x=TMedia,y=FLO), se= T, method='lm', color = "black")+
  labs(x="Temperatura média (ºC)", y="Data de florescimento (DAE)")+
  theme(plot.title = element_text(hjust = 0.5))
```
```{r}


    # teste de normalidade dos dados

b<-shapiro.test(Temporario$TMedia)
alfa<-0.05
c<- data.frame(c(b$p.value)) ; c<- c %>% mutate( resultado = case_when(c$c.b.p.value. <  alfa ~ "rejeita-se H0", c$c.b.p.value. > alfa ~ " não rejeita-se H0" , c$c.b.p.value. == alfa ~ " não rejeita-se H0" )) ; c<- c %>%  mutate( teste = case_when(resultado == "rejeita-se H0"  ~ "não paramétricos", resultado != "rejeita-se H0"  ~ "paramétricos" ))

m<- c %>% mutate( metodo = case_when(resultado == "rejeita-se H0" ~  "spearman", resultado != "rejeita-se H0"  ~ "pearson" ))
metodo<-m$metodo 

normalidade<-c$resultado 

```

```{r}
# Estatística
 
a<-c(var(x=Temporario$TMedia,y=Temporario$FLO)) 
c<-c(cor(x=Temporario$TMedia,y=Temporario$FLO)^2)
d<-cor.test(y=Temporario$FLO, x=Temporario$TMedia, method= metodo) 
f<-data.frame("Estatística" =c("S²", "Cor", "r²","Teste Shapiro-Wilk", "Método", "Valor_P"))
E<-data.frame("T. média" =c(a,d$estimate, c ,normalidade, metodo, d$p.value ))
Corre_est<-tableGrob(f)
Corre_med<-tableGrob(E)


```

```{r}
tem<-sort(Temporario$FLO)
n<-tem[1]
Te<-subset(Temporario, FLO == n)
rm(tem,n)
```

```{r}

Temporario<- TabelabrutaIRR %>% group_by(FLO) %>% summarise(Tmax = mean(Tmax_Media)) %>% na.omit(Temporario)

t_ma<-ggplot(Temporario)+
  geom_point(aes(x=Tmax,y=FLO),Temporario, color= "blue")+
  geom_smooth(aes(x=Tmax,y=FLO), se= T, method='lm', color = "black")+
  labs(x="Temperatura máxima (ºC)", y="Data de florescimento (DAE)" )+
  theme(plot.title = element_text(hjust = 0.5))
```

```{r}


    # teste de normalidade dos dados

b<-shapiro.test(Temporario$Tmax)
alfa<-0.05
c<- data.frame(c(b$p.value)) ; c<- c %>% mutate( resultado = case_when(c$c.b.p.value. <  alfa ~ "rejeita-se H0", c$c.b.p.value. > alfa ~ " não rejeita-se H0" , c$c.b.p.value. == alfa ~ " não rejeita-se H0" )) ; c<- c %>%  mutate( teste = case_when(resultado == "rejeita-se H0"  ~ "não paramétricos", resultado != "rejeita-se H0"  ~ "paramétricos" ))

m<- c %>% mutate( metodo = case_when(resultado == "rejeita-se H0" ~  "spearman", resultado != "rejeita-se H0"  ~ "pearson" ))
metodo<-m$metodo 

normalidade<-c$resultado 

```

```{r}

a<-c(var(x=Temporario$Tmax,y=Temporario$FLO)) 
c<-c(cor(x=Temporario$Tmax,y=Temporario$FLO)^2)
d<-cor.test(y=Temporario$FLO, x=Temporario$Tmax, method= metodo) 
E<-data.frame("T. máxima" =c(a,d$estimate, c , normalidade, metodo, d$p.value))

Corre_max<-tableGrob(E)
```

```{r}
Temporario<- TabelabrutaIRR %>% group_by(FLO) %>% summarise(Tmin = mean(Tmin_Media)) %>% na.omit(Temporario)

t_mi<-ggplot(Temporario)+
  geom_point(aes(x=Tmin,y=FLO),Temporario, color= "blue")+
  geom_smooth(aes(x=Tmin,y=FLO), se= T, method='lm', color = "black")+
  labs(x="Temperatura mínima (ºC)", y="Data de florescimento (DAE)")+
  theme(plot.title = element_text(hjust = 0.5))

```
```{r}


    # teste de normalidade dos dados

b<-shapiro.test(Temporario$Tmin)
alfa<-0.05
c<- data.frame(c(b$p.value)) ; c<- c %>% mutate( resultado = case_when(c$c.b.p.value. <  alfa ~ "rejeita-se H0", c$c.b.p.value. > alfa ~ " não rejeita-se H0" , c$c.b.p.value. == alfa ~ " não rejeita-se H0" )) ; c<- c %>%  mutate( teste = case_when(resultado == "rejeita-se H0"  ~ "não paramétricos", resultado != "rejeita-se H0"  ~ "paramétricos" ))

m<- c %>% mutate( metodo = case_when(resultado == "rejeita-se H0" ~  "spearman", resultado != "rejeita-se H0"  ~ "pearson" ))
metodo<-m$metodo 

normalidade<-c$resultado

```
```{r}
a<-c(var(x=Temporario$Tmin,y=Temporario$FLO)) 
c<-c(cor(x=Temporario$Tmin,y=Temporario$FLO)^2)
d<-cor.test(y=Temporario$FLO, x=Temporario$Tmin, method=metodo) #pearson , spearman ou kendall
E<-data.frame("T. mínima" =c(a,d$estimate, c , normalidade , metodo , d$p.value))

Corre_min<-tableGrob(E)

```
  
Relação da temperatura média, máxima e mínima com a data de florescimento 
  
```{r fig.align='center', out.width='100%', fig.asp=0.6, fig.width=9}
rm(Temporario)
T_O_IRR<-grid.arrange(t_me, t_ma, t_mi, ncol=3)
Corre_IRR<-grid.arrange(Corre_est,Corre_med,Corre_max,Corre_min, ncol=4)
```
  
   A menor data de floração foi aos **`r Te[1,1]`** dias após a emergência, onde a temperatura média foi **`r Te[1,2]`****ºC**. 
  
    
#### 3.2.1) Irrigado subtropical
  
```{r}
Temporario2<- TabelabrutaIRR %>% mutate( Clima= case_when(latitude <= -30 ~ "subtropical", latitude > -30 ~ "tropical"))

Temporario<- Temporario2 %>% filter(Clima=="subtropical") %>%  mutate( TMedia = ((Tmax_Media+Tmin_Media)/2)) %>% group_by(FLO) %>% summarise(TMedia = mean(TMedia)) %>% na.omit(Temporario)


 t_me<-ggplot(Temporario)+
  geom_point(aes(x=TMedia,y=FLO),Temporario, color= "blue")+
  geom_smooth(aes(x=TMedia,y=FLO), se= T, method='lm', color = "black")+
  labs(x="Temperatura média (ºC)", y="Data de florescimento (DAE)")+
  theme(plot.title = element_text(hjust = 0.5))
```

```{r}


    # teste de normalidade dos dados

b<-shapiro.test(Temporario$TMedia)
alfa<-0.05
c<- data.frame(c(b$p.value)) ; c<- c %>% mutate( resultado = case_when(c$c.b.p.value. <  alfa ~ "rejeita-se H0", c$c.b.p.value. > alfa ~ " não rejeita-se H0" , c$c.b.p.value. == alfa ~ " não rejeita-se H0" )) ; c<- c %>%  mutate( teste = case_when(resultado == "rejeita-se H0"  ~ "não paramétricos", resultado != "rejeita-se H0"  ~ "paramétricos" ))

m<- c %>% mutate( metodo = case_when(resultado == "rejeita-se H0" ~  "spearman", resultado != "rejeita-se H0"  ~ "pearson" ))
metodo<-m$metodo 

normalidade<-c$resultado 

```

```{r}
# Estatística
 
a<-c(var(x=Temporario$TMedia,y=Temporario$FLO)) 
c<-c(cor(x=Temporario$TMedia,y=Temporario$FLO)^2)
d<-cor.test(y=Temporario$FLO, x=Temporario$TMedia, method= metodo) 
f<-data.frame("Estatística" =c("S²", "Cor", "r²","Teste Shapiro-Wilk", "Método", "Valor_P"))
E<-data.frame("T. média" =c(a,d$estimate, c ,normalidade, metodo, d$p.value ))
Corre_est<-tableGrob(f)
Corre_med<-tableGrob(E)


```

```{r}
tem<-sort(Temporario$FLO)
n<-tem[1]
Te<-subset(Temporario, FLO == n)
rm(tem,n)
```

```{r}
Temporario<- Temporario2 %>% filter(Clima=="subtropical") %>%  group_by(FLO) %>% summarise(Tmax = mean(Tmax_Media)) %>% na.omit(Temporario)


t_ma<-ggplot(Temporario)+
  geom_point(aes(x=Tmax,y=FLO),Temporario, color= "blue")+
  geom_smooth(aes(x=Tmax,y=FLO), se= T, method='lm', color = "black")+
  labs(x="Temperatura máxima (ºC)", y="Data de florescimento (DAE)" )+
  theme(plot.title = element_text(hjust = 0.5))
```

```{r}


    # teste de normalidade dos dados

b<-shapiro.test(Temporario$Tmax)
alfa<-0.05
c<- data.frame(c(b$p.value)) ; c<- c %>% mutate( resultado = case_when(c$c.b.p.value. <  alfa ~ "rejeita-se H0", c$c.b.p.value. > alfa ~ " não rejeita-se H0" , c$c.b.p.value. == alfa ~ " não rejeita-se H0" )) ; c<- c %>%  mutate( teste = case_when(resultado == "rejeita-se H0"  ~ "não paramétricos", resultado != "rejeita-se H0"  ~ "paramétricos" ))

m<- c %>% mutate( metodo = case_when(resultado == "rejeita-se H0" ~  "spearman", resultado != "rejeita-se H0"  ~ "pearson" ))
metodo<-m$metodo 

normalidade<-c$resultado 

```

```{r}

a<-c(var(x=Temporario$Tmax,y=Temporario$FLO)) 
c<-c(cor(x=Temporario$Tmax,y=Temporario$FLO)^2)
d<-cor.test(y=Temporario$FLO, x=Temporario$Tmax, method= metodo) 
E<-data.frame("T. máxima" =c(a,d$estimate, c , normalidade, metodo, d$p.value))

Corre_max<-tableGrob(E)
```

```{r}
Temporario<- Temporario2 %>% filter(Clima=="subtropical") %>%  group_by(FLO) %>% summarise(Tmin = mean(Tmin_Media)) %>% na.omit(Temporario)

t_mi<-ggplot(Temporario)+
  geom_point(aes(x=Tmin,y=FLO),Temporario, color= "blue")+
  geom_smooth(aes(x=Tmin,y=FLO), se= T, method='lm', color = "black")+
  labs(x="Temperatura mínima (ºC)", y="Data de florescimento (DAE)")+
  theme(plot.title = element_text(hjust = 0.5))
```
```{r}


    # teste de normalidade dos dados

b<-shapiro.test(Temporario$Tmin)
alfa<-0.05
c<- data.frame(c(b$p.value)) ; c<- c %>% mutate( resultado = case_when(c$c.b.p.value. <  alfa ~ "rejeita-se H0", c$c.b.p.value. > alfa ~ " não rejeita-se H0" , c$c.b.p.value. == alfa ~ " não rejeita-se H0" )) ; c<- c %>%  mutate( teste = case_when(resultado == "rejeita-se H0"  ~ "não paramétricos", resultado != "rejeita-se H0"  ~ "paramétricos" ))

m<- c %>% mutate( metodo = case_when(resultado == "rejeita-se H0" ~  "spearman", resultado != "rejeita-se H0"  ~ "pearson" ))
metodo<-m$metodo 

normalidade<-c$resultado

```
```{r}
a<-c(var(x=Temporario$Tmin,y=Temporario$FLO)) 
c<-c(cor(x=Temporario$Tmin,y=Temporario$FLO)^2)
d<-cor.test(y=Temporario$FLO, x=Temporario$Tmin, method=metodo) #pearson , spearman ou kendall
E<-data.frame("T. mínima" =c(a,d$estimate, c , normalidade , metodo , d$p.value))

Corre_min<-tableGrob(E)

```
  
Relação da temperatura média, máxima e mínima com a data de florescimento 
    
```{r,  fig.align='center', out.width='100%', fig.asp=0.6, fig.width=9}

T_O_IRR<-grid.arrange(t_me, t_ma, t_mi, ncol=3)
Corre_IRR<-grid.arrange(Corre_est,Corre_med,Corre_max,Corre_min, ncol=4)
```
  
 A menor data de floração foi aos **`r Te[1,1]`** dias após a emergência, onde a temperatura média foi **`r Te[1,2]`****ºC**.   

#### 3.2.2) Irrigado tropical

```{r}
Temporario2<- TabelabrutaIRR %>% mutate( Clima= case_when(latitude <= -30 ~ "subtropical", latitude > -30 ~ "tropical"))

Temporario<- Temporario2 %>% filter(Clima=="tropical") %>%  mutate( TMedia = ((Tmax_Media+Tmin_Media)/2)) %>% group_by(FLO) %>% summarise(TMedia = mean(TMedia)) %>% na.omit(Temporario)


 t_me<-ggplot(Temporario)+
  geom_point(aes(x=TMedia,y=FLO),Temporario, color= "blue")+
  geom_smooth(aes(x=TMedia,y=FLO), se= T, method='lm', color = "black")+
  labs(x="Temperatura média (ºC)", y="Data de florescimento (DAE)")+
  theme(plot.title = element_text(hjust = 0.5))
```

```{r}


    # teste de normalidade dos dados

b<-shapiro.test(Temporario$TMedia)
alfa<-0.05
c<- data.frame(c(b$p.value)) ; c<- c %>% mutate( resultado = case_when(c$c.b.p.value. <  alfa ~ "rejeita-se H0", c$c.b.p.value. > alfa ~ " não rejeita-se H0" , c$c.b.p.value. == alfa ~ " não rejeita-se H0" )) ; c<- c %>%  mutate( teste = case_when(resultado == "rejeita-se H0"  ~ "não paramétricos", resultado != "rejeita-se H0"  ~ "paramétricos" ))

m<- c %>% mutate( metodo = case_when(resultado == "rejeita-se H0" ~  "spearman", resultado != "rejeita-se H0"  ~ "pearson" ))
metodo<-m$metodo 

normalidade<-c$resultado 

```

```{r}
# Estatística
 
a<-c(var(x=Temporario$TMedia,y=Temporario$FLO)) 
c<-c(cor(x=Temporario$TMedia,y=Temporario$FLO)^2)
d<-cor.test(y=Temporario$FLO, x=Temporario$TMedia, method= metodo) 
f<-data.frame("Estatística" =c("S²", "Cor", "r²","Teste Shapiro-Wilk", "Método", "Valor_P"))
E<-data.frame("T. média" =c(a,d$estimate, c ,normalidade, metodo, d$p.value ))
Corre_est<-tableGrob(f)
Corre_med<-tableGrob(E)


```

```{r}
tem<-sort(Temporario$FLO)
n<-tem[1]
Te<-subset(Temporario, FLO == n)
rm(tem,n)
```
 
```{r}
Temporario<- Temporario2 %>% filter(Clima=="tropical") %>%  group_by(FLO) %>% summarise(Tmax = mean(Tmax_Media)) %>% na.omit(Temporario)


t_ma<-ggplot(Temporario)+
  geom_point(aes(x=Tmax,y=FLO),Temporario, color= "blue")+
  geom_smooth(aes(x=Tmax,y=FLO), se= T, method='lm', color = "black")+
  labs(x="Temperatura máxima (ºC)", y="Data de florescimento (DAE)" )+
  theme(plot.title = element_text(hjust = 0.5))

```

```{r}


    # teste de normalidade dos dados

b<-shapiro.test(Temporario$Tmax)
alfa<-0.05
c<- data.frame(c(b$p.value)) ; c<- c %>% mutate( resultado = case_when(c$c.b.p.value. <  alfa ~ "rejeita-se H0", c$c.b.p.value. > alfa ~ " não rejeita-se H0" , c$c.b.p.value. == alfa ~ " não rejeita-se H0" )) ; c<- c %>%  mutate( teste = case_when(resultado == "rejeita-se H0"  ~ "não paramétricos", resultado != "rejeita-se H0"  ~ "paramétricos" ))

m<- c %>% mutate( metodo = case_when(resultado == "rejeita-se H0" ~  "spearman", resultado != "rejeita-se H0"  ~ "pearson" ))
metodo<-m$metodo 

normalidade<-c$resultado 

```

```{r}

a<-c(var(x=Temporario$Tmax,y=Temporario$FLO)) 
c<-c(cor(x=Temporario$Tmax,y=Temporario$FLO)^2)
d<-cor.test(y=Temporario$FLO, x=Temporario$Tmax, method= metodo) 
E<-data.frame("T. máxima" =c(a,d$estimate, c , normalidade, metodo, d$p.value))

Corre_max<-tableGrob(E)
```

```{r}
Temporario<- Temporario2 %>% filter(Clima=="tropical") %>%  group_by(FLO) %>% summarise(Tmin = mean(Tmin_Media)) %>% na.omit(Temporario)

t_mi<-ggplot(Temporario)+
  geom_point(aes(x=Tmin,y=FLO),Temporario, color= "blue")+
  geom_smooth(aes(x=Tmin,y=FLO), se= T, method='lm', color = "black")+
  labs(x="Temperatura mínima (ºC)", y="Data de florescimento (DAE)")+
  theme(plot.title = element_text(hjust = 0.5))
```
```{r}


    # teste de normalidade dos dados

b<-shapiro.test(Temporario$Tmin)
alfa<-0.05
c<- data.frame(c(b$p.value)) ; c<- c %>% mutate( resultado = case_when(c$c.b.p.value. <  alfa ~ "rejeita-se H0", c$c.b.p.value. > alfa ~ " não rejeita-se H0" , c$c.b.p.value. == alfa ~ " não rejeita-se H0" )) ; c<- c %>%  mutate( teste = case_when(resultado == "rejeita-se H0"  ~ "não paramétricos", resultado != "rejeita-se H0"  ~ "paramétricos" ))

m<- c %>% mutate( metodo = case_when(resultado == "rejeita-se H0" ~  "spearman", resultado != "rejeita-se H0"  ~ "pearson" ))
metodo<-m$metodo 

normalidade<-c$resultado

```
```{r}
a<-c(var(x=Temporario$Tmin,y=Temporario$FLO)) 
c<-c(cor(x=Temporario$Tmin,y=Temporario$FLO)^2)
d<-cor.test(y=Temporario$FLO, x=Temporario$Tmin, method=metodo) #pearson , spearman ou kendall
E<-data.frame("T. mínima" =c(a,d$estimate, c , normalidade , metodo , d$p.value))

Corre_min<-tableGrob(E)

```
  
Relação da temperatura média, máxima e mínima com a data de florescimento 
  
```{r,  fig.align='center', out.width='100%', fig.asp=0.6, fig.width=9}
T_O_IRR<-grid.arrange(t_me, t_ma, t_mi, ncol=3)
Corre_IRR<-grid.arrange(Corre_est,Corre_med,Corre_max,Corre_min, ncol=4)
```

  
 A menor data de floração foi aos **`r Te[1,1]`** dias após a emergência, onde a temperatura média foi **`r Te[1,2]`****ºC**.   
 
```{r}
rm(Temporario)
rm(a ,b,c,E)
rm(Corre_est,Corre_med,Corre_max,Corre_min, t_me, t_ma, t_mi)
```

  

